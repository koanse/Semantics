Введение
1.Управление в технических системах
Одновременно с появлением технических систем возникла необходимость разработки систем управления для них. Одной из первых технических систем, достаточно сложных и требующих  обязательного применения автоматического управления или регулирования, была паровая машина, изобретенная И.И. Ползуновым в 1763 и запатентованная в виде универсального двигателя в     1774 - 1784 гг. Дж. Уаттом. С момента создания и до конца 19 века (до создания двигателей внутреннего сгорания и электрических двигателей) паровые двигатели являлись единственными силовыми установками на транспорте и в промышленности. Как известно схема паровой машины представляет собой цилиндр с поршнем, соединенным с коленчатым валом. В цилиндр подается пар, нагретый до высокой температуры в паровом котле, пар толкает поршень, который совершает возвратно-поступательное движение, преобразуемое с помощью коленчатого вала во вращательное.
В паровой машине возникли сложные задачи регулирования, назовем две из них:
1) как обеспечить постоянную скорость вращения вала машины
2) как обеспечить постоянный уровень воды в паровом котле. 
Заглянуть в котел конечно нельзя. В связи с этим был изобретен поплавковый регулятор уровня жидкости, который используется в различных модификациях и по сегодняшний день: самый простой и широко распространенный пример - регулирование уровня воды в сливном баке в туалете. Для решения первой задачи - регулирования  скорости вращения вала Дж. Уатт изобрел центробежный регулятор скорости также довольно простой и одновременно надежный регулятор. Его суть в следующем (рис. 1).   На вал насажены  две муфты, одна подвижная, другая неподвижная. Между ними пружина. С неподвижной муфтой с помощью шарниров связаны грузы. Центробежная сила грузов пропорциональна скорости вращения вала. В результате подвижная муфта скользит вверх при увеличении скорости и вниз при ее уменьшении. С ней связана задвижка, клапан, регулирующий подачу пара и скорость.
 
Рис. 1.
С появлением энергосиловых установок другого типа - дизельных, электрических, с увеличением их мощности, скорости осуществления                                                 операций потребности в управлении быстро нарастали. Нарастала                                                    и сложность принципов, в соответствии с которыми нужно было                                                      организовывать управление или регулирование.
Управление - это целенаправленная организация того или иного процесса, обеспечивающая достижение определенных заданных целей. Процессы могут быть самыми разными и происходить в различных системах: технических, социальных, экономических, экологических и т.п. Принципы управления являются достаточно общими и распространяются на системы различной природы. Системы автоматического и автоматизированного управления в первую очередь, конечно, создаются для технических систем.
В последние десятилетия благодаря бурному развитию цифровой техники управление проникает во все отрасли деятельности человека не только в производственных условиях, но и в быту. Если раньше автоматизировались отдельные операции и агрегаты, то  теперь автоматизируются производственные процессы, процессы проектирования изделий и технологий, подготовки производства и полностью автоматического управления им, включая решение задач планирования производства, приобретения сырья, управления сбытом и т.д. и т.п. Глобальные сети предоставляют новые широкие возможности для дальнейшего углубления задач управления в экономике и в социальной сфере.
2.Общие принципы системной организации
Естественно, что решение задач управления, получение законов управления базируется на некоторых формально-математических основах, образующих теорию управления. В основном это математика, ориентированная на нужды задач управления.
Принципы управления, как уже отмечено, не зависят от содержательного существа задачи. Для их иллюстрации рассмотрим процесс управления автомобилем. Водитель смотрит на дорогу и видит, куда нужно ехать, одновременно он следит за тем, куда едет автомобиль. Из сравнения реальной траектории и скорости движения автомобиля с наблюдаемой ситуацией на дороге, водитель принимает (формирует) решение о том, что ему делать: вращать руль, жать на акселератор или на тормоз. Далее он реализует, исполняет принятое решение. В этом примере можно усмотреть четыре принципиальных элемента (шага), которые имеются при любом управлении.
1)	цель управления: что нужно получить, куда двигаться;
2)	получение информации о состоянии объекта: что получаем, куда движемся;
3)	определение отклонения желаемого от действительного и выработка управляющего воздействия;
4)	отработка, исполнение управляющего воздействия.
Если все четыре шага реализуются автоматически, то система является автоматической, в противном случае - автоматизированной. 
На основании выше изложенного общую схему САР можно представить в виде:
 
Рис. 2.
Если элементов много, то каждый из них имеет входы и выходы;  при соединении выходы одного предыдущего соединяются с входами  последующего и становятся внутренними для системы. Такие переменные на стыке внутренних элементов, на которые может быть разделена система, называются состояниями, т.к. они характеризуют состояние системы. Мы будем использовать эти термины.      
Входы самого первого внешнего элемента системы являются внешними входами всей системы, аналогично - выходы последнего элемента - выходы всей системы. Если их по одному - система одномерная, если несколько, то система многомерная или векторная. 
При построении автоматических и автоматизированных систем используются различные принципы, о которых мы сейчас и поговорим.
3.Общие принципы управления
(программное управление, управление с обратной связью, адаптивное управление, оптимальное управление, нечеткое управление)
3.1. Управление с обратной связью
Всегда, когда имеется информация о состоянии объекта, о результатах управления ее следует использовать для повышения качества управления. В рассмотренной выше схеме мы использовали такой принцип - принцип обратной связи. В этом случае при выработке управления используются информация о текущем состоянии объекта и о его желаемом состоянии, а управляющее воздействие вырабатывается функцией невязки.
3.2.  Программное управление
Если нет возможности получения информации о результатах управления, можно попробовать обойтись без них (как человек с завязанными глазами). На этом основан принцип программного управления,  управления по разомкнутому циклу. Важнейшими определяющими характеристиками такого управления является точность модели и правильность цели. 
Пример: станки с программным управлением.
3.3.Адаптивное управление
Пусть имеется модель следующего вида:
  = S ai fi( x, u)                                                                                          (1.1)
где   – выход объекта,
x – вектор состояний,
u – вектор управлений.
Из наблюдений мы имеем  и  - измеренные значения x и  . Задача адаптивного управления сводится к минимизации квадрата невязки, т.е.
Q(ai) = ( -  )2   min                                                                                (1.2)
3.4.Оптимальное управление
Оптимальное управление значит наилучшее в каком-либо смысле.
Пусть  - наилучшее значения выхода, тогда критерий оптимальности можно сформулировать в следующем общем виде:
 F(u) = F {  -  S ai fi(x,u)}                                                                           (1.3)
При этом F может иметь вид квадрата, модуля и т.д.
Требований бывает много и часто их приходится свёртывать в один комплексный критерий. При этом разным требованиям назначают разные приоритеты.
Пусть  . Каждый   является каким-либо критерием. В этом случае критерий оптимальности можно представить в следующем виде:
                                                                              (1.4)
где m может быть минимумом, максимумом и т.п.
3.5.Стохастическое управление
Часто оказывается, что входные величины, приложенные к системе, имеют стохастический характер. В этом случае нельзя использовать детерминированные алгоритмы, а следует применять стохастические, в которых в качестве характеристик используются величины среднего значения, средне квадратичного отклонения, дисперсии и т.д.

3.6. Нечеткое управление
Во многих ситуациях нельзя указать четкого однозначного функционального соответствия между величинами, характеризующими состояния входа и выхода объекта. Можно лишь говорить об этом с некоторой степенью достоверности, установленной разными способами, например, опросом экспертов. К примеру, какой-то элемент   на 0,9.
Величины (входы, выходы, состояния и прочие) принадлежат нечетким размытым множествам, и законы управления строятся тоже на построении нечетких соответствий между этими нечеткими множествами. 
3.7.Дискретное и непрерывное управление
Управление всех видов может быть либо дискретным, либо непрерывным. Непрерывное обычно используют в аналоговых устройствах (электрические машины).  Дискретное или дискретно-непрерывное управление применяется как правило в цифровых устройствах (ЭВМ).

2.Объекты, системы и их модели
2.1.Математические модели систем управления и объектов управления.
Как отмечалось, необходимо управлять самыми различными объектами: скоростью вращения электродвигателя, температурой в печах, скоростью  движения полосы в прокатном стане, толщиной полосы, линией по выпечке хлеба или производству пива и т.д. Понятно, что вербальное описание для этого не годится. Управление сводится к добавлению, уменьшению, перераспределению некоторых ресурсов, изменению величин (в большинстве случаев метрических). Т.е. управление нужно вычислить, определить количественно. Для этого необходимо иметь математические соотношения. Объект управления необходимо описать математически - разработать его математическую модель, т.е. систему математических отношений связывающих все величины, характеризующие рассматриваемый объект и  представляющие интерес для решаемой задачи. Таким образом, математическая модель - это система математических соотношений, связывающих и описывающих поведение величин, полностью характеризующих изучаемый объект в необходимом смысле. Математическая модель объекта используется как при  его анализе, так и синтезе системы управления им.
Очевидно, что система управления - совокупность датчиков и задающих устройств, алгоритмов обработки сигналов и определения управляющих воздействий, исполнительных устройств – также должны быть описаны в виде модели.
Таким образом, мы имеем дело всегда с математической моделью объекта и системы. Природа объектов может быть самой разной и их формальное представление - модели также будут отличаться. Для того, чтобы унифицировать методы анализа объектов  и синтеза систем, их желательно классифицировать по каким-либо признакам.

2.2. Способы классификации моделей (объектов).
1) По виду сигналов: непрерывные, дискретные, импульсные.  Общий вид модели - дифференциальные и разностные уравнения.
2) По определенности поведения объекта: детерминированные и стохастические. Общий вид модели - математические уравнения различного рода и вероятностные характеристики: среднее значение, квадрат среднего значения, дисперсия, корреляционная и взаимно-корреляционная функции.
3) По виду множеств входов и выходов: если значения располагаются в одной точке - сосредоточенные, а если распределены в некоторой области – распределенные. Общий вид модели - обыкновенные дифференциальные уравнения,  уравнения в частных производных.
4) По тому, в какой степени входят в уравнения переменные и их производные модели делятся на линейные и нелинейные ( у = Ах, у =f(х))
5) В зависимости от постоянства параметров: стационарные и нестационарные (у = f(х),  у = f(х,t).
 При моделировании следует стремиться к рациональному уровню соответствия между моделью и ее прототипом  (объектом).
Модель имеет две стороны: содержательную и формально-математическую. Абсолютно точную модель создать нельзя, поэтому она должна отражать существенные стороны объекта и одновременно, по возможности, быть простой.
2.3. Формально-математические отличия моделей
(дискретных и непрерывных, линейных и нелинейных, стационарных и нестационарных, детерминированных и стохастических моделей,           одномерных  и многомерных)
Начнем с конца и запишем достаточно общее выражение модели объекта
                                                                                           (2.1)
где x - вектор состояний, w - вектор входных воздействий, f - вектор-функция. 
Модель вида (2.1) описывает непрерывную, многомерную, нестационарную, нелинейную, детерминированную (если вектор w детерминированный)  систему.
Детерминированность означает одновременную определённость всех величин.
x(k+1) =f(x(k),w(k),k)                                                                                  (2.2)
  - описывает дискретную многомерную, нестационарную, нелинейную, детерминированную (если w - детерминированный вектор)  систему.
                                                                                               (2.3)
- описывает непрерывную многомерную, стационарную, нелинейную, детерминированную (если w - детерминированный вектор)  систему.
x(k+1) =f(x(k),w(k))                                                                                   (2.4)
- описывает дискретную многомерную, стационарную, нелинейную, детерминированную (если w - детерминированный вектор)  систему.
                                                                          (2.5)
- описывает непрерывную многомерную, нестационарную, линейную, детерминированную (если w – детерминированный вектор)  систему.
x(k+1) =A(k)x(k) +B(k) w(k),                                                                     (2.6)
- описывает дискретную многомерную, нестационарную, линейную, детерминированную (если w – детерминированный вектор)  систему.
                                                                                      (2.7)
- описывает непрерывную многомерную, стационарную, линейную, детерминированную (если w - детерминированный вектор)  систему.
x(k+1) =Ax(k) +B w(k),                                                                                (2.8)
- описывает дискретную многомерную, стационарную, линейную, детерминированную (если w – детерминированный вектор)  систему.
В случае, когда w(k) является стохастическим векторным процессом, для него используются следующие характеристики:
- вектор средних значений:
m(k) = E {w(k)}                                                                                              (2.9)
E – оператор взятия математического ожидания.
- ковариационная матрица:  
Rw(k1,k2) = E{[w(k1) - m(k1)][w(k2) - m(k2)]T}                                             (2.10)
Rw(k,k) = Q(k) - матрица дисперсий
- матрица смешанных моментов второго порядка:
Cw(k1,k2) = E {w(k1),wT(k2)}                                                                        (2.11)
Cw(k,k) = Q’(k)  матрица моментов второго порядка
 В таких же терминах получают выходные величины, которыми мы управляем. Целью управления является достижение определенных, чаще минимальных значений дисперсий, ковариаций.
3. Построение моделей объекта и методы упрощения моделей
3.1.Методы упрощения моделей
Мы уже отмечали, что модель желательно иметь как можно проще. Поэтому исходную модель, полученную из физических законов и отражающую реальные процессы в объекте во время его жизнедеятельности, целесообразно упростить, если это не противоречит целям решения.
Мы отмечали, что наиболее общей непрерывной моделью является (2.1.) Наметим возможный путь перехода от нее к самой простой из перечисленных нами  непрерывных детерминированных   моделей (2.7). Мы можем следовать той же последовательности, которая была намечена выше.
Допустим, что нам известны временные рамки,  в которых эволюционирует объект. Пусть t0 - начальный, а t - конечный момент времени интервала, представляющего интерес. Из анализа поведения во времени параметров модели (2.1)  следует определить такие необязательно одинаковые полуинтервалы, открытые, например, справа
dti = ti - ti-1 i=1,2,...,   ti-1 ?  t  <  ti,
Можно допустить, что внутри этих интервалов с достаточной для решаемой задачи точностью модель изменяется несущественно и этими изменениями можно пренебречь, вследствие чего можно принять параметры объекта постоянными, равными их значениям при ti-1. Тогда можно вычислить значения функций f = (f1, f2, ..., f¬n) при ti, i = 0,1,2,....,n-1  и записать вместо одной нестационарной модели (2.1) последовательность стационарных моделей вида
 ,  , i = 0, 1, 2, ....,n-1                                            (3.1)
Модель   будет использоваться для всех значений t I[ti, ti+1).
Следующий часто применяемый прием состоит в линеаризации нелинейной модели. Используются различные способы линеаризации. Рассмотрим один наиболее часто употребляемый и простой. Он базируется на использовании известного вам разложения функций в ряд Тейлора. Обычно заранее можно оценить в каком диапазоне будут изменяться входные величины, состояния и выходы объекта. Если диапазон широк, то его можно разбить на несколько более узких так, чтобы сохранить требуемую точность. Независимо от количества интервалов техника сохраняется и состоит в следующем. Возьмем некоторую точку, называемую рабочей, внутри интервала. Обозначим ее индексом 0, т.е. x0,w0.  Т.к. (3.1) известно, то можно вычислить и  .
Разложим (3.1) в ряд Тейлора в точке  . Получим
                (3.2)
где i=1,2…n – это номер временного интервала, на котором система стационарна,  j=1,2…n,  l=1,2…m.
 
Теперь если  ,  (представляют собой якобианы), тогда каждому интервалу времени будут соответствовать свои  .
Обозначим  ,  .

Учитывая новые обозначения, перепишем (3.2) и получим линейный аналог или линейное приближение  (3.1)                       
                                                                                     (3.3)
Видно, что (3.3) соответствует (2.7).
4. Сложные системы. 
4.1.Принципы организации реальных и искусственных систем управления. 
Выше мы говорили, имея в виду технические системы и объекты различной природы. Но системы могут быть не только технические. Например, ЛГТУ, металлургический комбинат,  ЦУМ, город Липецк, РФ - все это системы, которыми необходимо управлять. Достаточно общее определение системы можно дать следующее: система есть обособленное от окружающей среды множество взаимосвязанных объектов, в совокупности выполняющих определенные функции.
Сложная система это система, состоящая из систем обычно различной природы, называемых подсистемами. Полностью обособленная от внешней среды система называется консервативной.
Эволюционирующая система не может быть консервативной, т. к. она должна получать энергию, необходимую для поддержания жизнедеятельности. Кроме того, наиболее часто цели жизнедеятельности системы, ее функционирования определяются внешними по отношению к ней объектами. Поэтому обособленность системы от внешней среды не является полной.
Сложная система обладает рядом характерных черт: целостность, целенаправленность, необходимость управления, саморегулирование, самоорганизация, сложная внутренняя структура, описываемая различными законами или неизвестная, неполная определенность (элементы черного или серого ящика), наличие смеси детерминированных и стохастических процессов, наличие неизмеримых, а также неметрических величин. 
Все перечисленные выше примеры систем наделены отмеченными свойствами. Например, государство - целостность, целенаправленность: защита человека, личности от внешних опасностей - армия, от внутренних - милиция, полиция, управление осуществляется системой законов, саморегулируемость обеспечивается рынком, самоорганизация обеспечивается в любом демократическом государстве наличием иерархической структуры самоуправления, сложность структуры, неопределенность, стохастичность - все эти элементы присутствуют в государстве как системе. 
Вербальное описание не годится - оно, с одной стороны, избыточно и одновременно, с другой - неоднозначно. Однако при описании сложных систем формальные модели, приведенные во втором параграфе, также недостаточны и не дают возможности представить все возможные объекты и связи, присутствующие в сложной системе. Более абстрактным и поэтому широким и емким является кортежное описание систем, которое допускает использование не только моделей вида (2.1) - (2.11), но и включение разнообразных алгоритмов, процедур и пр.
Обозначим m – какой-либо объект или элемент: материальный, энергетический, информационный и т.п., обладающий некоторыми существенными для системы в рассматриваемом смысле свойствами,   
M = {m }    , mIM  - совокупность объектов, образующих систему;
x – связь или обмен между элементами системы энергией, веществом, информацией (сигналами) и т.п.
X = {x} - множество связей, присутствующих в системе;
F  - функция системы, не элементов системы, а именно всей системы в целом.  
Теперь систему, используя кортежное описание, можно записать в виде
S : { M,X,F },                                                                                            (4.1)
Это простое, наиболее абстрактное описание системы без указания типа и свойств M,X,F. Но оно не бессмысленно и не бесполезно, т.к. дает возможность включить различного типа объекты и связи. Если число элементов m ®?, то система большая, но не обязательно сложная. Сложной является, как мы уже отмечали, система, состоящая из подсистем  различной природы и структуры:
M1, M2 ,..., MR : Mi = {mi } = {mi1, mi2,..., mini},
между которыми имеются связи также различной природы и содержания:
X1, X2, ...,XL  :    Xi = {xi1, xi2, ..., ximi },  
цель функционирования F,
Sсл : { M1, M2 ,..., MR , X1, X2, ...,XL , F }                                                  (4.2)
Реальные системы - те, которые не являются результатом творческой деятельности человека, например, экологическая система, живые организмы, в некотором смысле социальные системы. К искусственным же естественно отнести создаваемые человеком технические системы, различные государственные институты, предприятия и организации, например, наш университет (факультеты, кафедры, подразделения, коммуникации и системы жизнеобеспечения); некоторые занимают промежуточное положение, например, государство - оно существует объективно, но его структура, организация, принципы управления можно считать искусственными.
Важно отметить, что принципы описания систем, методы их изучения и  анализа являются едиными и составляют существо системного подхода. 
4.2.Многоуровневые иерархические системы управления. Структурные  схемы  систем и объектов  управления
Структура и иерархия. Структура - это расчленение системы на части с указанием связей между ними. Это расчленение постоянно на все время рассмотрения системы и осуществляется оно с целью более наглядного выявления основных свойств системы. Разделение может быть материальным, алгоритмическим, функциональным и т. п. В группы элементы объединяются по принципу простых и более сильных связей, а разграничение производится по принципу более слабых связей. (4.2) отражает факт расчленения системы на подсистемы. Примеры: институт, алгоритм (подпрограммы, функции, операторы), книга - информационное (научная литература), материальное при изготовлении, содержательно-эстетическое для художественной литературы.
Мы уже упоминали, что возможно графическое отображение структуры системы. Группы объектов, образующие блоки  обозначаются прямоугольниками, связи - линиями со стрелками:
Все разнообразие возможных структур можно свести по определенным правилам преобразования структурных схем к трем представленным схемам последовательного, параллельного и соединения с обратной связью (рис. 3).
 
Рис. 3.
Возможно деление не по принципу тесноты связей, который используется в структуре, а по иным соображениям, например, для достижения удобства описания, или с точки зрения физических явлений, или для удобства проектирования и т.п. Такое разделение для упрощения представления называют декомпозицией системы.
Иерархией  называется структура с наличием подчиненности, т. е. неравноправных связей между элементами или блоками системы, когда воздействия в одном направлении существенно более значимы, чем в другом. Часто при наличии между  объектами двусторонней связи каналы не равноценны: в одну сторону идут управления, в другую информация. Примеры: государство, университет, предприятие и т.п.
 
Рис. 4.
 Наиболее распространенные древовидная и ромбовидная иерархические структуры (рис. 4). Иерархия сужает возможности низших уровней, гибкость системы, ее эффективность, но она существенно упрощает задачу принятия решения и структуру, по крайней мере, на первый взгляд.    

4.3.Иерархия целей. Компромиссы и комплексные критерии.
В большинстве систем, рассматриваемых в практической деятельности, протекают, развиваются некоторые процессы. При этом именно характер развития этих процессов и представляет интерес. Естественно, что процессы эти должны развиваться некоторым желательным в каком-либо смысле  для нас образом, приближаться к некоторой определенной цели. При создании искусственных систем в рамках системного подхода цель является побудительным мотивом создания системы. Т.к. система влияет на внешнюю среду через выходные величины, то цель, скорее всего, должна выражаться через них. Кроме того, состояние самой  системы, также представляет интерес, поэтому и состояния могут участвовать в  формировании цели. Таким образом, процессы в системе должны развиваться целенаправленно и целенаправленность является важнейшей характеристикой системы.
Управление представляет собой целенаправленное вмешательство в эволюцию системы. Управления идут к системе извне. Они формируются некоторым управляющим модулем (модулем принятия решения).
В сложной системе имеется множество целей управления. Каждая подсистема может иметь свою цель. Цели могут совпадать, существенно различаться и противоречить одна другой. В иерархической системе каждый уровень имеет свои цели, которые можно выстроить в порядке важности или приоритета. В результате получим дерево целей подобное  структуре   системы и отражающее структуру целей. Построение дерева целей с указанием каждой из них места и соподчиненности  называется структуризацией целей. В сложной системе структура целей может быть достаточно сложной и сама представлять собой некую систему, в которой цели могут рассматриваться последовательно, параллельно, с обратной связью.  
Определение целей для системы наиболее важная и сложная задача при разработке систем. В большинстве случаев имеют место усложняющие вопрос обстоятельства. Главные из них следующие:
       1) целей бывает много и они противоречивы,
  2) цели не всегда могут быть точно определены,
  3) ресурсы управления всегда ограничены и недостаточны для полного удовлетворения всех целей. 
Отсюда следует, что цели могут удовлетворяться не полностью, в различной степени на условиях компромисса между ними. Особые сложности представляет ситуация нечеткого определения целей, когда нельзя формально записать, что хорошо, а что плохо. Часто в подобных ситуациях прибегают к экспертным оценкам, с помощью которых организуется альтернативный критерий.
В простейших случаях, когда несколько целей могут быть выражены количественно, их можно собрать в один комплексный критерий.                Например,  , l = 1,2,...,L - частные цели, значения которых нужно максимизировать, тогда критерий можно представить в виде 
         F(y) =  a  al jl(y), l = 1,2,...,L                                                         (4.3)
где   al  - весовые коэффициенты, устанавливающие приоритеты отдельных целей.
Наличие (4.3) упрощает построение процедуры принятия решения. Если же множество альтернатив нельзя упорядочить в виде (4.3), возникает сложная проблема принятия решения, т.е. выбора из множества альтернатив поведения системы одного. Это специальная проблема. 
5.Качество управления
5.1.Основные характеристики систем управления
5.1.1. Временные характеристики
Мы остановимся в качестве примера на наиболее простых линейных системах.
Их движение описывается дифференциальными уравнениями вида (2.5)
  = A(t)x(t) + B(t)w(t), t?t0                                                                       (5.1)
В общем случае кроме состояний x(t), имеются выходные величины, которые могут являться алгебраической функцией состояний. Обозначим их вектором y(t) и запишем в общем виде:
y(t) = C(t)x(t) , t?t0                                                                                                    (5.2)
Для того, чтобы выяснить поведение объекта, надо решить (5.1), чтобы найти x(t). Это неоднородное дифференциальное уравнение. Его решение состоит из общего однородного и частного неоднородного.
Решение однородного 
  = A(t)x(t)                                                                                                 (5.3)
имеет вид   
x0(t) = Ф(t,t0) x(t0)                                                                                        (5.4)
где   - заданные начальные условия
где Ф(t,t0) в соответствии с (5.3), (5.4) должна удовлетворять
                                                                              (5.5)
Частное решение неоднородного уравнения
  = Ф(t,t0) v(t)                                                                                       (5.6)
где v(t) - неизвестная функция, которую следует определить так, чтобы удовлетворялось (5.1). Подставим (5.6) в (5.1)
  =  v(t) + Ф(t,t0)  
A(t) Ф(t,t0)v(t) + Ф(t,t0)   = A(t) Ф(t,t0)v(t) + B(t) w(t)
откуда
 = Ф-1(t,t0) B(t) w(t)
v(t) =                                                                  (5.7)
Подставим (5.7) в (5.6)        
                                                             (5.8)
Общее решение:  x(t) = x0(t) + xч(t)
                                      (5.9)
Свойства переходной матрицы Ф(t,t0) :
а) Ф(t2,t1)Ф(t1,t0) = Ф(t2,t0)            " t0, t1,t2,
б) | Ф(t,t0) | ?  0           " t0, t,  
в) Ф(t,t0) = Ф(t0,t)            " t0, t,  
г)  = -A T(t) ФT(t0,t)            " t0, t,  
Используя свойства в) и а)  матрицу перед интегралом можно ввести под знак интеграла в формулах (5.8) и (5.9). В результате последняя принимает следующий вид:
                                                   (5.9a)
где первое слагаемое отражает влияние начального состояния на текущее и отображает переходной процесс, а второе – отражает влияние входных воздействий.
            Ф(t,t0) - переходная, фундаментальная матрица системы. Пояснить смысл. На ее основе получаются другие временные характеристики системы: импульсная и переходная функции системы. Добавим в рассмотрение уравнение для выходных величин  (5.2)
y(t) = C(t)x(t) , t?t0
Подставим в него (5.9)
                                    (5.10)
Отметить смысл составляющих.    Пусть x(t0) = 0, тогда
 
K (t,t) = C(t) Ф (t,t) B(t),  t ? t                                                             (5.11)
(5.11) - представляет собой матричную импульсную или весовую  функцию: реакция выхода yn(t) системы на  вход  wm(t) характеризуется весовой функцией k n m (t,t).
Важное значение имеет интегральная характеристика, показывающая интегральную реакцию выхода на ступенчатую функцию, поданную на вход в момент времени  t. Она называется матричной переходной функцией системы и определяется в соответствии с отмеченным в виде
 ,                                                                     (5.12)
Элемент s n m (t, t)   характеризует интегральную реакцию выхода yn(t) на ступенчатую единичную функцию, поданную на вход m в момент времени  t:     wm(t) = 1.
Импульсная (весовая) и переходная функции являются важнейшими временными характеристиками системы, по которым можно судить о поведении системы и ее качестве. Разумеется, что для скалярной системы они будут скалярными функциями, а для матричной (многомерной) матричными, но последнее равносильно множеству характеристик, записанных отдельно для всевозможных сочетаний входов и выходов системы.
До сих пор в этом параграфе мы говорили о линейных системах общего вида. Если ограничиться классом только стационарных систем, то результаты упростятся. 
Т.к. для стационарной системы  (с постоянными параметрами)  (2.7)
 = Ax(t) + Bw(t)                                 
фундаментальная матрица представляет собой матричную экспоненту  , то (5.9), (5.10) принимают соответственно вид:
                                                    (5.13)
                                                 (5.14)
                                                         (5.15)
Матричная экспонента вычисляется по обычной формуле разложения экспоненциальной функции в ряд. Только вместо скаляра ставится матрица.
Пример построения модели объекта.
Построение модели мы проиллюстрируем на примере.
Условие: дан смесительный бак (рис. 5). Растворы с концентрацией   и  , предназначенные для смешивания, поступают в бак по двум трубам. Скорость подачи растворов регулируется при помощи двух кранов, обозначенных на рисунке пятиугольниками. Смесь, имеющая концентрацию С, выходит из бака по специальной трубе. Учитывая, что объём, занимаемый в баке смесью равен V, а высота столба смеси равна h, построить математическую модель данного процесса и найти её характеристики.

 
Рис. 5

Уравнение баланса масс                                (1)
   = c1F1(t) + c2F2(t) -c(t)F(t)                                                     (2)

Т.к. расход зависит от высоты, то можем записать:
F(t) =                                                                                                 (3)
где К - коэффициент пропорциональности.
Если S – площадь поверхности бака, тогда
                                                                                                 (4)
Подставим (4.) в (1) и (2), получим
                                                                          (5)
                                                          (6)
Теперь проведём линеаризацию. Пусть номинальные (установившиеся) значения параметров равны  , подставив их в (4)-(6), получим:
0=                                                                                     (7)
0=                                                                            (8)
                                                                                                   (9)
При линеаризации мы находим отклонения величин:
   - управление
  - состояния
Для того, чтобы линеаризовать разложим все величины в уравнениях (5), (6) в ряд Тейлора с удержанием линейных частей разложения, т.к. все они первой степени, кроме
 
           
                                                           (10)
            (11)
Заменив в соответствии с (9)   на  , а затем, подставив (10) в (11) и обозначив   (время заполнения бака), получим
                                         (12)
X(t) - вектор состояний  
U(t) – вектор управлений   
       
Выходы
                                                                       (13)
                                                                               (14)

                                                           (15)
Пусть установившееся значение численно равны   ,  ,  ,  ,
 .
Подставив эти значения, получим
                                           (16)
                                                                                     (17)
Данная система стационарная, следовательно, её фундаментальная матрица  .
Т.к.        ?                                                         (18)
   (19)
           (20)

5.1.2.Передаточная функция (операторные характеристики)
Из дисциплин математического блока вы знаете, что существуют операторные методы описания систем и сигналов. Часто для сокращения записи используется оператор дифференцирования  D. Умножение на этот оператор равносильно (обозначает) дифференцированию:  @ ,                @  ,...,    @  , тогда дифференциальное уравнение
a n  + an-1    +  ...  + a1  +  a0x = bm   + 
+bm-1  + .... + b1  + b0w                                                                   (5.16)
можно записать в виде
 a (D) x(t)  =   b (D) w(t)                                                                           (5.17)
где    a (D) @ a n Dn + an-1 Dn-1  +  ...  + a1 D +  a0,
b (D) @bm Dm + bm-1D m-1 + .... + b1D + b0                                                                                                      
Такое преобразование сводится к изменению формы записи. Существенные изменения вносит другое операторное преобразование, известное вам. Преобразование Лапласа, определяемое
                                                                (5.18),
где L  - образ, f  - прообраз, оригинал. Преобразование Лапласа позволяет перейти из временной области в операторную. Ценность преобразования Лапласа в том, что при нулевых начальных условиях достаточно просто связаны между собой функция, её производная и интеграл т.е. при f(0) = 0 
L [ ] = F(p), то  L[ ] = p F(p) и т.п.   
L[Dnf(t)] = pnF(p), n?  0, так что
L[A(D)f(t)] = A(p)L[f(t)]  = A(p) F(p)                                                     (5.19)
Применив преобразование Лапласа к стационарной системе (2.7)
 
получим 
p X(p) -x(0) = AX(p)  + B W(p)
(pI  - A)X(p) = x(0)  + B W(p)  отсюда находится X(p).  
Т.к. для выходных величин уравнение y(t) = C x(t),   Y(p) = C X(p)
Y(p) = C(pI  - A)-1x(0) +C(pI  - A)-1BW(p)                                               (5.20)
Важнейшей характеристикой системы является передаточная функция, которая определяется как отношение изображений по Лапласу выхода ко входу:  
H(p) =   = C(pI  - A)-1B                                                                    (5.21)
(pI  - A)-1 = Ф(p) - фундаментальная матрица системы или резольвента.
Ее находят, например, так. 
Пусть А - n ? n матрица с постоянными параметрами, имеющая характеристический полином det(pI-A) = pn + an-1 pn-1 +  ... +  a1p + a0,              то резольвента Ф(p)  может быть записана в виде
                                                         (a)
 где  , i=1,2…n,  
Для определения  R i , i = 1,2,....,n  можно рекомендовать следующий алгоритм , пусть 
an = 1 , Rn = 1, 
тогда  ,                                                          (б)
Rn-k =  an-kI  +  AR n-k+1 , k = 1, 2, ,...., n,                                                            (в)
при  k = n  должно быть  R0  =  0.
Это метод Сурье или Фаддеевой, который следует из алгоритма Леверье. Условие  R0 = 0 может быть использовано для проверки.  Существуют и другие методы. Например, следствие из теорема Кели-Гамильтона (каждая квадратная матрица удовлетворяет своему характеристическому уравнению) и др.
Пример:  дана система
        
Найти Ф(p).
Решение:
Способ №1.  , т.к.  , тогда
 ,  ,         
 
Способ №2:
n=2, k=1,    
 
 
 
 
 
5.1.4. Логарифмические частотные характеристики
Логарифмической амплитудной характеристикой (ЛАХ)  соответствующей передаточной  функции Н(р) называется функция
L (q) = 20lg |H(jw )| 						                          (5.35)
определенная для любых вещественных значений q = lg w. 
Наклоном ЛАХ называется функция dL/dq. Принято измерять значение ЛАХ в децибелах (дБ), а наклон в дБ/декаду.
Логарифмической фазовой характеристикой (ЛФХ) называется функция 
 y(q) = Arg H(jw)									      (5.36)

Особенно просто строятся логарифмические характеристики для передаточных функций. с вещественными нулями и полюсами. Передаточная функция такого типа представима в виде

H(p) = k pn [Пn (T’n  p + 1)/ Пm (Tm  p + 1)]					      (5.37)
где  T’n   ,Tm  - положительные постоянные времени. Пусть к - положительно, тогда ЛАХ и ЛФХ:
L (q) = 20lg k + 20 nq+ an 20lg | (T’n w)2 + 1 | 1/2 - am20lg | (Tmw)2 +1|1/2   (5.38)
y(q) = n p/2 + an Arctg wT’n  -  am Arctg wTm                                             (5.39)
Эти формулы сложны, но анализ показывает возможность их приближенного использования, учитывая близость к ломаной. Действительно один член 
L (q) =20lg | (Tmw)2 +1|1/2  
при  w<< 1/T,  Tw<1, (Tw)2<<1, L(0)@0,  
при w> 1/T, Tw>1, (Tw)2>>1 и L(0)@ 20lg  (Tmw)
Отсюда определение. Асимптотической ЛАХ , соответствующей Н(р) вида (5.37), называется кусочно-линейная функция, получаемая заменой (5.38) на асимптотические ломаные вида
       			                                           (5.40)
                
w =1/T  -сопрягающая частота, w< 1/T- низкочастотная асимптота, w> 1/T - высокочастотная асимптота.
Асимптотическая ЛФХ есть кусочно-постоянная функция, получающаяся из (5.39) заменой
    					                       (5.41)
Замечательное свойство асимптотических характеристик в том, что они строятся без вычислений по следующему алгоритму
1. 	Строится низкочастотная асимптота Lнч (q) = 20lg k + 20 nq
2. 	Упорядочиваются все постоянные времени (частоты) 
        T1 > T2 > .....  >  Tn , w1 = 1/T1 < w2 = 1/T2  <  .....< wn =1/Tn 
3. 	Положить Lас (q) = Lнч (q)  вплоть до w1
4. 	Если Т1 принадлежит числителю, то начиная с w=w1 проводится прямая с наклоном на 20 дБ/дек больше, если знаменателю, то меньше; 
5. 	Продолжаем до w2 и переходим на п.4.
Пример: Н(р) = k/p[(T2p + 1)/(T1p + 1)(T3 p + 1)], T1 > T2 >T3    

 
   
5.1.5. Структурные схемы
Отдельные подсистемы или звенья 
 

В операторном виде с учетом (5.19) уравнения системы можно записать в виде
A(p) X(p) = B(p) W(p)						                          (5.42)
Y(p) = C(p) X(p) 						                                    (5.43)
где X(p) - изображение по Лапласу переменной состояния, W(p) - входной и Y(p) - выходной переменных.
A(p) @ an pn  + an-1pn-1 +  .... + a1p + a0 многочлен от переменной р
B(p), C(p) - аналогичные многочлены ( (5.42) есть результат преобразования по Лапласу (5.17).
Из (5.42),(5.43) получаем
Y(p) = [C(p) B(p) / A(p)] W(p)						              (5.44)
Y(p) = H(p) W(p), H(p) = C(p) B(p) / A(p)				             (5.45)

Пусть система состоит из i = 1,2,...,n звеньев (подсистем)
Yi(p)  =  Hi(p) Wi(p), i =1,2,...,n 					                        (5.46)

Wi(p) =    				                                             (5.47)
       
 Wi' - внешние связи.
Для состояний уравнения получаются непосредственно из (5.42) Все состояния, обозначенные  Xi(p), i = 1,2,...,n образуют вектор состояний системы. Выходы, не являющиеся входами других элементов данной системы, есть выходы системы. Входы элементов системы, не являющиеся выходами других элементов этой системы являются внешними входами. Входы и выходы могут быть как векторными, так и скалярными.
В общем случае система состоит множества элементов, соединенных между собой. Для анализа целесообразно эти элементы выделить в качестве отдельных звеньев, а потом объединить в одну систему. При всем кажущемся разнообразии соединений, фактически имеют место только 3 возможные схемы соединения элементов или звеньев.
Пусть число элементов равно 2. 
Последовательное соединение


 
W1=W ' , W2=Y1 ,  Y2=Y , 
Y1(p)=H1(p)W1(p),
Y2(p)=H2(p)W2(p), 
Y(p)= Y2(p)=H2(p)W2(p)= Y2(p)=H2(p) H1(p)W1(p),
H(p)= H2(p) H1(p),
p = jw, 
H(jw) = H2(jw ) H1(jw ) , 
 | H(jw)| = |H2(jw )| |H1(jw )|, 
arg H(jw) =arg H2(jw ) + arg H1(jw )

Характеристическое уравнение можно получить следующим образом:

A1(p) Y1(p) = C1(p) B1(p) W1(p)
A2(p) Y2(p) = C2(p) B2(p) W2(p),       W2(p)=Y1(p)
 * = *W1(p)
 
det A = A1(p)A2(p),    

Параллельное соединение

 
Y1(p)=H1(p) W(p),       Y2 (p)= H2 (p)W(p),        Y1(p)+Y2(p)=Y(p),       H(p) = H1(p)+H2(p),         
 H(jw) = H2(jw ) + H1(jw ),                      
 R(H) =R(H1) + R(H2), 
I(H) = I(H1) + I(H2),                                              
Операторное представление может быть следующим
A1Y1 = C1B1W,    
A2Y2= C2B2W,   
 * = *W(p)
 
det A = A1(p)A2(p) 
Соединение с обратной связью
 

A1(p)Y1 (p)= C1(p)B1(p) W1 (p),  
A2(p)Y2(p) = C2(p)B2(p)W2(p) ,    
Y(p)=Y1(p),  W2(p)=Y1(p),        W1(p)=W(p)-Y2(p);
H1(p)=A1-1(p)C1(p)B1(p) 
H2(p)=A2-1(p)C2(p)B2(p)

 Y= W
          
         det A = A1(p)A2(p) + C1(p)B1(p)C2(p)B2(p)

Передаточные функции
Y(p) = Y1(p) = H1(p)W1(p) = H1(p) ( W(p) - Y2(p)) = H1(p) (W(p) - H2(p)W2(p)) = H¬1(p)W(p) - H1(p)H2(p)Y(p); 
 Y(p) = [H1(p) / (1 + H1(p)H2(p))]W(p)
H(p) =[H1 (p) / (1 + H1 (p) H2 (p))]. 
Если H2 =1, то обратная связь называется жесткой.
Если W1(p)=W(p)+Y2(p), то обратная связь называется положительной, если W1(p)=W(p)-Y2(p), то отрицательной.
Система с обратной связью может быть разомкнутой. В этом случае H(p)=H1(p)H2(p)
Часто приходится структурную схему, состоящую из множества звеньев приводить к виду системы с обратной связью или к одному из рассмотренных видов. При этом бывает целесообразно переносить, т.е. менять местами звенья и узлы. Эти изменения осуществляют так, чтобы передаточная функция изменяемого участка не изменялась. 
5.2. Анализ устойчивости систем управления
5.2.1. Определение устойчивости систем
     

Случай а соответствует устойчивому состоянию системы, б – неустойчивому, в - безразличному
 (t) = f(x(t), u(t), t) 							                          (5.48)
При анализе исследуется поведение решения уравнения (5.48) при  t®?. 
Пусть   u(t) = const  = 0 – анализируется поведение уравнения без внешних воздействий.
        (t) = f(x(t),  t) 								                (5.49)
пусть х0(t) - номинальное состояние, соответствующее решению уравнения
       (t) = f(x0(t),  t) 						                          (5.50)  
Определение 1. Пусть есть уравнение (5.49) с номинальным решением x0(t). Номинальное решение уравнения (5.49) является устойчивым в смысле Ляпунова А.М., если для " t0  и " e > 0 существует d(e, t0)>0  такое, что при  || x(t0) - x0(t0)|| ? d удовлетворяется  неравенство  ||x(t)  -  x 0(t)|| < e    "t ? t0. Здесь  || x || - норма вектора х, равная корню квадратному из суммы квадратов компонент. Это слабая устойчивость.
Определение 2. Номинальное решение уравнение (5.49) является асимптотически устойчивым , если :            
        а)  оно устойчиво в смысле Ляпунова;
        б) " t0 $ такое r(t0) > 0 , что в случае  ||x(t0) - x0(t0)|| < r имеем  ||x(t) - x0(t)||  ® 0 при t ® ?.
Определение  3. Номинальное решение уравнения (5.49) является асимптотически устойчивым в целом  (большом), если:
       а) оно устойчиво в смысле Ляпунова;
       б)" x(t¬0)  и  " t0  имеет место   ||x(t) - x0(t)|| ® 0 при  t ® ?         (5.51)
Для линейных систем устойчивость уравнений совпадает с устойчивостью систем.
Определение  4. Линейная дифференциальная система
           (t) = A(t)x(t)                                   
устойчива в определенном смысле (по Ляпунову, асимптотически, в целом) если её тривиальное решение x0(t) = 0 устойчиво в этом смысле.

5.2.2.  Устойчивость линейных стационарных систем
Рассмотрим систему   (t) = Ax(t)    		                                           (5.52)
Теорема  1. Пусть А  - n?n матрица,  l1 ,l2, l3,..., ln  её различные характеристические числа, а    e1 , e2,  ..., en соответствующие собственные векторы.  
Определим n?n  матрицы  T =      (e1, e2 ,..., en),    		                       (5.53)
                                           L = diag ( l1,  l2 ,...,  ln ) 		             (5.54)
тогда Т не особая и А может быть представлена в виде
 А = ТL Т-1    			(5.55)
Говорят, что в этом случаеТ диагонализирует А.
Формулу (5.55) можно также записать в виде TА Т-1 = L    
Кроме того имеет место факт   а)   e At = T  e Lt  T-1     		             (5.56)
                                    б) e Lt = diag (e l t , el t ,  ...., e l t )  		   (5.57)
Теорема 2 . Имеем систему (5.52) , где А удовлетворяет условиям теоремы 1 Запишем Т-1 в виде
                     				                                           (5.58)

где fi строки из собственных векторов. Тогда решение (5.52) при t0 =0 может быть записано в виде
x(t)  =  ain  elitei fi x(0), или обозначив скалярные произведения fix(0) = mi, то решение можно записать в виде
x(t) =  ain  mi e lit  ei    	(5.59) 
Отсюда видно, что реакция системы может быть представлена в виде комбинации движений по собственным векторам матрицы А. Такое движение называется модой системы. Каждая мода имеет соответствующие компоненты по собственным векторам и возбуждается соответствующим начальным условием. Диагонализация упрощает определение реакции системы. Если корни кратные , то  в (5.55) вместо L будет стоять жорданова норм форма матрицы А, где на месте кратного корня li кратности mi  будет стоять блок размера mi ? mi , а реакция кроме членов  exp(lit) будет включать в (5.59) и члены вида
  t exp (lit), t2 exp (lit),  t3 exp (lit),   .....,  tm-1 exp (lit).
 Из (5.59) видно, что реакция есть сумма экспонент и следовательно система будет устойчива  при любых mi, если все li <  0.  
Теорема 3. Система с постоянным параметрами (5.52) является асимптотически устойчивой тогда и только тогда, когда все характеристические числа матрицы А имеют строго отрицательные действительные части. 

5.2.3. Алгебраические критерии устойчивости
Должно быть li  <  0 – действительные части. 
Пусть   а0 > 0  
а0р + а1 = 0. 
l = -a1/ a0,  
Если a1 > 0,  то l<0. 
a0 (p -l1 )(p - l2 ) ... (p -ln ) = 0 раскрыв при условии li  > 0 или li,i+1=a+jb и   a > 0 мы получим хотя бы один отрицательный коэффициент. Отсюда можно сформулировать необходимое условие устойчивости: необходимым условием устойчивости является положительность всех коэффициентов системы. 
Достаточное требует дополнительных условий. Они сформулированы Раусом и Гурвицем в виде критерия Гурвица: для устойчивости необходимо и достаточно чтобы все определители Гурвица были больше нуля.

 >0

Алгоритм  Рауса позволяет проверить устойчивость более просто.
Пусть а0 , а1 . ............,аn коэффициенты характеристического уравнения, тогда
от j = 1 до  n -1   
1) вычислить значение  rj=an-j+1/ an-j                                                            (*)
если rj ?0 , то многочлен неустойчив, иначе 2)
2) от k = 1   определить значение a n-2k - j + 1 = a n-2k - j + 1 - rj a n-2k - j                   (**)
                                               вернуться к 1).
Если все rj , j = 1, 2, ..., n-1  больше  0, то многочлен устойчив. 
5.2.4. Частотные критерии устойчивости
Об устойчивости характеристического уравнения можно судить по поведению корней на комплексной плоскости и по их поведению при изменении частоты. 
Рассмотрим положение годографа (конца вектора Н(р)) на комплексной плоскости при изменении р. 
Пусть Н(р) описывает замкнутую кривую С. Рассмотрим векторы р -a   и р-g, где a - вне, а g  - внутри контура С.


 

Нетрудно видеть, что при обходе контура С аргумент числа р - a изменяется на  0, в то время как аргумент р - g  на 2p. Теперь, если Н(р) - передаточная функция, которая имеет внутри контура С h нулей m1 ,m2 ,...,m  и  l полюсов n1, n2, ..., nl, то её можно представить в виде
 
При обходе аргументом р кривой С по ходу часовой стрелки аргумент числителя получит приращение 2ph, а аргумент знаменателя  2pl, следовательно аргумент дроби изменится на 2p(l - h).
Если h>l , то Н(р) обходит начало координат по часовой стрелке h - l раз, если h<l  , то точка Н(р) обходит начало координат против часовой стрелки l -h  раз.
Мы помним, что передаточная функция замкнутой  системы с жесткой отрицательной обратной связью имеет вид H(p) / 1 + H(p).  Следовательно её характеристическое уравнение есть знаменатель передаточная функция замкнутой  системы и для него начало координат переносится в точку ( -1, 0) 
На этом основании получены следующие критерии Михайлова - Найквиста

Замкнутая система автоматического регулирования будет устойчива, если её частотная характеристика в разомкнутом состоянии H(jw), имеющая m полюсов в правой полуплоскости, при изменении w  от 0 до ? охватывает точку с координатами ( -1 ,0) m/2  раз в положительном направлении (против часовой стрелки).

 

На рисунке изображены два годографа для системы с m=0. 1-я система устойчива, т.к. годограф не пересекает  (- ?, -1]; 2-я система не устойчива. Частота, при которой годограф пересекает единичную окружность называется частотой среза, угол gф -запас устойчивости по фазе, НМ – запас устойчивости по модулю. Они оговариваются в технических условиях на систему и обеспечивают её работоспособность даже при отклонениях параметров от номинальных.
6. Методы анализа и синтеза систем  управления.
6.1. Анализ систем управления, корневой годограф
 Анализ систем управления включает  исследование устойчивости, качества, т.е. степени удовлетворения заданных характеристик качества, исследование динамической точности систем. Последнее особенно важно для следящих систем, в которых задающее воздействие - величина переменная во времени. Мы вкратце познакомимся с этими вопросами.
 Основной принцип проектирования систем состоит в том, что система должна быть устойчивой.
Анализ устойчивости занимает исключительное положение. Кроме выяснения вопроса об устойчивости необходимо определить диапазоны варьирования параметров, в которых устойчивость сохраняется. 
    Чтобы быстро проследить поведение системы целесообразно использовать не точные вычисления, требующие много времени даже при использовании ЭВМ, а приближенные методы. Один из них метод корневого годографа.
Характеристическое уравнение замкнутой системы можно представить в виде
1  +  H(р) = 1 + K ?(р)/?(р) =  ?(р) + K?(р) = 0 			                (6.1)
Совокупность точек рi, удовлетворяющих уравнению (6.1) при различных К, образует корневой годограф системы.
  Таким образом, корневой годограф это геометрическое место точек – значений корней характеристического уравнения системы при изменении скалярного параметра от 0 до бесконечности.  В качестве  скалярного параметра часто выступает неизвестный вначале коэффициент усиления. Передаточная функция замкнутой системы в соответствии с изложенным в 5.1.5. для соединения с обратной связью равна
Hз(p) = Hp(p) / [1 +  Hp(p)Hoc(p)]                                                    
Её можно представить в виде (6.1)
      ?(p) + ??(p)                  		                                                         (6.2)
где ?  , ?  - полиномы от р, а ? - параметр. Полиномы можно представить в виде
  ?(p) =  ?i (p  - ?i) , i=1,2,...,n; ?(p) = ?i(p  - ?i), i=1,2,..,m  		      (6.3)
где  ?i ,  i=1,2,..,n - полюса разомкнутого контура, а ?i, i=1,2,...,m - его нули.
Корни (6.2) называют полюсами замкнутого контура. Пусть m ? n, в обратном случае можно поменять местами ?, ?  и выбрать параметр 1/?. 
Свойства корневого годографа - они используются и для его построения
1) 	Число корней многочлена (6.2) равно n . Каждый из них имеет свой непрерывный годограф при изменении ? от -?   до  ?.
2) 	Начало годографа при ? = 0 в полюсах ?i,i=1,2,...,n. Это следует из того, что ? = 0 корни (6.2 ) являются корнями ?(р).
3) 	Поведение годографа.  При ????  m годографов стремятся к нулям ?i, i = 1,2,...,m. Остальные n - m годографов стремятся к бесконечности, т.к. корни (6.2) являются и корнями 
          ?-1 ?(р) + ?(р)                                         
4) 	Асимптоты годографов n - m годографов, стремящихся к бесконечности, асимптотически приближаются к  n - m прямым, которые составляют углы
       (? + k2?)/ (n - m),  k = 0, 1, .., n -m - 1,     		                           (6.4)
c положительной действительной осью при ??? и углы
      k2? / (n - m),  k = 0, 1, .., n -m - 1,            		                                (6.5)
при  ?? - ?. Эти n - m  асимптот пересекаются в одной точке на действительной оси, определяемой выражением
 ( ?in ?i -  ?im ?i) / (n - m)                                		                                (6.6)
5) 	Части годографа на действительной оси. Если ? принимает только положительные значения, то любая часть действительной оси, справа от которой располагается нечетное количество полюсов и нулей на действительной оси, является частью корневого годографа. Если  ? принимает только отрицательные значения, то любая часть действительной оси, справа от которой на действительно оси лежит четное число полюсов и нулей, является частью корневого годографа.
6.2. Управление, обратная связь, стабилизация.
6.2.1. Цель управления , идеальное управление.
  Общую схему объекта и системы управления можно представить в виде


 

r(t) – эталонная переменная (заданное желаемое значение управляемой переменной z)
y – наблюдаемая переменная
vP – возмущающая переменная
vm  - шум наблюдений

Цель управления. 
Целью управления является по возможности
  z(t) ? r(t),  t?t0                                                                    	                            (6.7)
Разомкнутый регулятор u(t)  = fp [r(?), t0???  t], t?t0                                    (6.8)
Замкнутый регулятор u(t)  = fз [r(?), t0???  t; y(?), t0???  t], t?t0                  (6.9)
Объект + регулятор = система управления. 

Идеальное управление
Будем считать y(t) = z(t), т.е. мы наблюдаем именно управляемую переменную. r(t) - заданное значение выходной переменной.
Если
1) 	необходимо, чтобы y(t) ? r(t), t ? t0 – задача слежения
2) 	r(t) = r0 ? t ? t0 – задача  регулирования, стабилизации
Пусть ?(t) = y(t) - r(t)                                                                                     (6.10)
         ?(t) = 0  ? t ? t0                                                                                      (6.11)
Это – идеальное управление. Говорят , что система инвариантна по отношению к действующим возмущениям.  Пусть объект описывается линейными дифференциальными уравнениями. Воспользуемся для краткости при записи дифференциальных уравнений оператором дифференцирования, введенным в п.п. 5.1.2. , т.е. запишем их в виде (5.17) и т. к. мы будем определять управление,  то разделим на две составляющих вектор w(t) = [u(t), v(t)], а именно на управление u(t) и возмущение v(t). Тогда уравнения для состояний и для выходных переменных системы можно записать в виде
 
 y(t) = ?(D) x(t) 
Подставляя 1-е во 2-е, находим для выходной (управляемой) переменной выражение
           ?(D) y(t) = ?(D) u(t)  +  ?(D) v(t),                                                    (6.12)
где ?, ?, ?  - многочлены от оператора дифференцирования, которые выражаются через  , ,  ,?.
Подставим (6.10) в (6.12)   ?(D)[r(t) + ?(t)] = ?(D) u(t)  +  ?(D) v(t), отсюда ошибка
           ?(D) ?(t) = ?(D) u(t)  +  ?(D) v(t) -?(D) r(t),                                      (6.13)
Примем два условия
1)	?(t), ?’(t), ?’’(t),...,?(n-1) = 0, n - степень ?;
2)	многочлены ?, ?, ? и значения г(t), v(t), t ? 0 известны точно.
Тогда из (6.13) в соответствии с (6.11) можно определить инвариантное управление
          ?(D) u(t) =  ?(D) r(t) -  ?(D) v(t)                                                          (6.14)
При управлении (6.14) ошибка будет равна нулю
          ?(D) ?(t) = 0      при ?(t) = ?’(t) = .... =0                                              (6.15)
Идеальное управление особенно просто получить, если  ?(D) =?0=const
       u(t) =  ?0-1 ( ?(D) r(t) -  ?(D) v(t))                                                           (6.16)
Пример. (TD+1)y(t) = u(t)  - объект ;    y(0) = 0, ?0 = 1. r(t) = C? t ?1(t), C - const, t?0.
По (6.16) получим u(t) = 1? (TD + 1)?C? t? 1(t) = C(T + t)? 1(t), t ?0.
При ?(D) ? const (6.14) можно преобразовать по Лапласу и найти соответствующий образ U(p)
 U(p) = [?(p) / ?(p)] R(p)  -  [?(p) / ?(p)] V(p)                                              (6.17)
Оригинал  u(t)  L - образа  U(p)   и будет управлением, обеспечивающим инвариантность системы.
Так что при предположениях 1),  2) всегда найдется инвариантное  управление. Однако оно может быть не ограничено, а предположения 1) и особенно 2) не выполнимы на практике.
Влияние неточности модели  
Пример. Объект (D - 1)y = u(t) + v(t), 	r(t) = 0, v(t) = C 1(t) тогда получаем
  0 = u(t) + v(t),  u(t) = - v(t) .
Если С известно не точно и   ? C, то имеем
(D - 1)y =   1(t) - C 1(t) = (  - C) 1(t) и выход определится в виде
 y(t) = (et  -  1)(   - C) 1(t)
если даже (  - C)  мала, то все равно при  t??  выходная величина станет сколь угодно большой.
Отсюда следует, что программное управление весьма чувствительно к неточностям модели и приводит к неустойчивости объекта с длительным временем функционирования.
6.2.2. Стабилизация с помощью обратной связи
Программное управление реализует принцип выбора управления (6.8). Если есть возможность наблюдать результат управления , т.е. значения выходной переменной прямо или косвенно, то всегда следует использовать эту информацию для управления и стабилизации системы. Даже исходно неустойчивую систему введением обратной связи можно сделать устойчивой, т.е. стабилизировать. 
Пусть система описывается уравнением
?(D) y(t) = ?0 u(t)  +  ?(D) v(t),                                                             (6.18)
определим управление в виде двух составляющих
u(t) = uf (t)  +  u0(t),                                                                                (6.19)
где первая составляющая - обратная связь, а вторая какое-либо другое управление.
Определим uf (t) = -k(D) y(t)                                                                (6.20)
где   k(D)  = k0 + k1D + ....+ krDr ,                                                        (6.21)
т.е. (6.21) предполагает, что мы можем измерять y(t), y’(t), .... , y( r )(t) или вычислить их. Подставим (6.20) в (6.19), а (6.19) в (6.18)
[?(D)  +  ?0 k(D)] y(t) = ?0u0(t) + ?(D) v(t)                                          (6.22)
Отсюда видно, что характеристический полином системы изменился: был ?(р),  стал
?(р) = ?(р)  + ?0 k(p)                                                                            (6.23)
Пусть ?d(p) - устойчивый полином, выберем    ?d(p) = ?(р)  + ?0 k(p), тогда если 
k(p) =  (?d(p) - ?(р))/?0                                                                          (6.24)
то система будет устойчивой. Следовательно, подбирая k(p) можно влиять на свойства системы, например, обеспечивая устойчивость.
Пример. Объект  (TD3 + D2)y = 0  неустойчив. 
Его характеристический полином Tp3 + p2 = 0; 
p1 = -1/T, 	p2 = p3 = 0. 
Введем обратную связь в виде u = -k0y - k1Dy - k2D2y и подставим её в (6.18)
 (TD3 + D2)y = - k0y - k1Dy - k2D2y 
или [TD3 +(1 + k2) D2 + k1D + k0] y = 0. Характеристический многочлен будет 
Tр3 +(1 + k2) р2 + k1р + k0 = 0. Определим его коэффициенты так, чтобы все корни были отрицательными, например - с-1, где с ? 0. (p + 1/c)3 = 0, p3 + (3/c) p2 + (3/c2 ) p + 1/c3  = 0. Приравниваем коэффициенты 3/c=(1+k2)/ T  ?  k2  = (3T/c)-, аналогично k1 = 3T/c2, k0 = T/c3.  
Величину с можно варьировать и тем самым влиять на скорость затухания эффектов от ненулевых начальных условий.
Характеристический многочлен всегда можно привести к виду
?(p)  =  pn  +  ?n-1 pn-1  + ... +  ?1p  + ?0. 
Пусть желаемый устойчивый полином имеет вид
?d(p) = pn  +  ?dn-1 pn-1  +  ....  + ?d1p  +  ?d0  .
Выбором коэффициентов  ?dn-1 , ... , ?d0  можно задать любое расположение корней на комплексной плоскости. Тогда в соответствии с (6.24) k(p) является многочленом степени n -1
k(p)  =  kn-1 pn-1  + .... + k1p + k0                                                                 (6.25)
где ki  =  (?di  -  ?i) / ?0 , i = 1, 2, ..., n-1                                                    (6.26)
6.2.3. Общий алгоритм определения стабилизирующей обратной связи
Пусть теперь ?(D) произвольный многочлен степени не выше n. В этом случае передаточная функция по каналу управление – выход строго реализуема. Примем закон управления в более общем, чем  (6.20) виде. Примем, что обратная связь строится в виде решения уравнения
      m(D)uf(t) = - k(D)y(t)                                                                          (6.27)
где m(D)  - произвольный многочлен, отличный от нуля.
При m(D) =1 имеем частный случай (6.20). Часто встречается более общий закон ПИД (пропорционально интегрально дифференциальный)
 uf(t) = - k0 ? y(t) dt - k1 y(t) - k2 dy(t)/dt  , что эквивалентно    дифференциальному уравнению
 Du(t)  =  - ( k0 + k1D + k2D2) y(t),                                                            (6.28)
записываемому в виде (6.27) при m(D) =D. 
Подставим в уравнение объекта (6.12) закон управления  u(t) = uf(t) + un(t), где un(t) - программное управление. Тогда уравнение объекта (6.12) и уравнение обратной связи (6.27) образуют систему:
?(D) y(t) = ?(D)[ uf (t) + un (t)] +  ?(D) v(t),                                          (6.29)
m(D)uf(t) = - k(D)y(t).
Исключив  обратную связь и преобразовав по Лапласу, получим
[?(p)m(p)  +  ?(p) k(p)]Y(p)  =  m(p)[?(p) Un(p)  +  ?(p)V(p)]              (6.30)
Характеристический полином замкнутой системы имеет вид
?(p)  =  ?(p) m(p)  +  ?(p) k(p)                				           (6.31)
     Теорема 1. Пусть многочлены ?(р) ,?(р) являются взаимно простыми. Тогда многочлены k(p), m(p) , определяющие вид обратной связи (6.27) могут быть выбраны так, что характеристический многочлен замкнутой системы ?(р) имел произвольные наперед заданные коэффициенты, т.е. заданное расположение корней.
     Следствие. Пусть многочлены являются взаимно простыми или имеют в качестве наибольшего общего делителя устойчивый многочлен. Тогда можно выбрать обратную связь вида (6.27), обеспечивающую устойчивость замкнутой  системы при неустойчивом объекте. В противном случае стабилизация объекта невозможна.
    В итоге можно сформулировать алгоритм стабилизации объекта, заданного в виде (6.12)	
1. Найти наибольший общий делитель ?0(р) многочленов ?(р) и ?(р). Если он неустойчив, то стабилизация невозможна. Если ?0(р) устойчив, то следует выделить взаимно простые многочлены
     ?1(p)  =  ?(p) / ?0(p),  ?1(p)  =  ?(p) / ?0(p).
Пусть ( Degree - степень)  deg(?1)=?,  deg(?1)=?, так что ?1 = р?  +  p?-1  +.....
2. 	Выбрать ?+? -1 чисел ?1 , ?2 , ... , ?? +? -1 c отрицательными вещественными частями и составить многочлен
?d(p)  =  (p - ?1) (p  -  ?2) ....(p  -  ?? + ? -1) = p? + ? - 1  +  ?? + ? - 2  p? + ? -2  +  ....+  ?0 
3. 	Из тождества ?1(p) m(p)  + ?1(p) k(p)=?d(p) найти ?+ ? линейных уравнений относительно ? + ? неизвестных коэффициентов многочленов: 
k1(p)=k10+k11p+ ....+k1? -1  p? -1  ,    
m1(p) = m10  +  m11 p +....+m1? - 1 p? - 1
4. 	Найти решение этих уравнений, т.е. вычислить значения этих коэффициентов
5. 	Записать стабилизирующий закон управления в виде дифференциального уравнения (6.27). Это уравнение однозначно определяет закон изменения u(t), если только заданы начальные условия, т.е.  m-1 начальных значений  u(t) и его производных.  Задание этих значений не влияет на сам факт обеспечения устойчивости замкнутой системы.
6.2.4. Некоторые другие законы управления
Кроме рассмотренного управления с обратной связью по выходу, возможно множество вариаций законов и принципов управления . В каждом конкретном случае проектировщик решает какой вариант следует выбрать с учетом особенностей объекта и требований к качеству управления. Мы кратко отметим некоторые возможности.
 Комбинированное управление с обратной связью по выходу  и программное управление 
Пусть объект  и управление (6.29), в результате  реализации обратной связи по выходу получена система (6.30).
?(p)Y(p)  =  m(p)[?(p) Un(p)  +  ?(p)V(p)]                                              (6.32)
где   ?(p)  =  ?(p) m(p)  +  ?(p) k(p).
К замкнутому объекту, который устойчив уже можно применить программное управление. В частности, если внешнее воздействие v(t) и эталонное значение выходной величины  r(t) известны точно, то программное управление un(t) ,  рассчитанное из уравнения 
 ?(p) R(p) = m(p) ?(p) Un(p) + m(p) ?(p) V(p)                                          (6.33)
гарантирует ?(t) = 0, t??, если были нулевые начальные условия.
Управление по возмущению    
Если возмущение может быть точно измерено, то можно управление построить по закону
?(D) u(t) = -  ?(D)v(t)                                                                                 (6.34)
такое управление компенсирует возмущение. Однако, если многочлен неустойчив, то малейшая ошибка при компенсации накопится; во-вторых, если многочлен ?(р) имеет корни в правой полуплоскости, то при ненулевых начальных значениях управления u(t) решение (6.34) содержит возрастающую компоненту , приводящую к вредному росту управления u(t).
Управление с обратной связью по ошибке
Часто контролируется не сама выходная величина , а её отклонение от заданного значения, т.е. ошибка  ?(t).  Пусть контролируется ошибка, равная
   ?(t)  =  r(t)  -  y(t)                                                                                    (6.35)
С помощью вычислительного устройства ?  можно вычислить и преобразовать в управляющий сигнал по алгоритму
  m(D) u(t) =  k(D) ? (t)                                                                             (6.36)
или u(t)  =  Hf(D) ?(t)				                                        (6.37)
Из (6.35) следует, что управление можно разделить на две составляющих	u(t) = u1(t)  +  u2(t) 
  u1(t)  = Hf(D) r(t)                                                                                      (6.38)
  u2(t)  =  - Hf (D) y(t)                                                                                 (6.39)
Составляющая (6.39) уже изучена и может быть использована для стабилизации. U1(t) - можно определить так, чтобы достичь желаемого r(t). Из уравнения объекта (6.12) , (6.35) и (6.36) следует для ошибки ?(t) уравнение
?(D) ?(t)  =  m(D) ?(D) r(t) - m(D) ? (D) v(t)                                          (6.40)
?(t)  =  [ 1  -  Hз(D)]s(t)                                                                             (6.41)
где 
Нз(D) = 1 - [m(D)?(D)] / ?(D) = ?(D) k(D) / [?(D) m(D) + ?(D)k(D)] = Hp(D) / [1  +   Hp(D)]        (6.42)
Hp(D) = ?(D) k(D) / [?(D) m(D)] = Huy(D) Hf(D)                                   (6.43)  
s(t) = r(t) - Hvy(D) v(t)                                                                               (6.44)
Hvy(D) = ? (D) / ?(D)                                                                                (6.45)
Нр(р) – передаточная функция разомкнутого контура или системы; Нз(р) – передаточная функция замкнутой системы или контура., s(t)- приведенный сигнал, или отрабатываемое воздействие.
 


6.3. Выбор желаемой передаточной функции по типовым воздействиям
6.3.1. Некоторые характеристики качества управления

 
Как правило, характеристики регулирования связаны с видом процесса и различными его параметрами. Системы по величине установившегося значения делятся на статические и астатические. При этом если установившееся значение = 0 система астатическая, не равно 0 - система статическая. 
Чтобы система являлась статической по отношению к воздействию необходимо, чтобы её передаточная функция по данному воздействию (каналу) при p?? обращалась в постоянную величину, а чтобы система была астатической необходимо, чтобы передаточная функция при р=0 имела нуль какого-либо порядка, этот порядок называется порядком астатизма системы.

Используются различные характеристики качества управления и функционирования системы. Среди них:
xm - максимальное отклонение регулируемой переменной;
?m - значение максимума перерегулирования в %;
tр - время протекания переходного процесса;
tm - время наступления первого максимума;
(dx/dt)m - максимальная скорость отработки регулируемой переменной.
Часто характеристики связываются с воздействием на систему. Используются типовые воздействия или сигналы. В настоящее время используется следующий подход .
1) 	Система должна быть устойчивой
2) 	Если сигнал имеет вид возрастающей функции, то установившаяся ошибка должна быть ограниченной и не больше заданной, т.е. сигнал
 ,                                                                                    (6.46)
то установившаяся ошибка его отработки ??(t)    должна быть 
 	                                                                                             (6.47)
где   - заданные значения.
3) 	Если входное воздействие является периодическим с ограниченной амплитудой, то и ошибка должна быть ограниченной в рабочей полосе частот, или при воздействии
 ,   		                                                                (6.48)
при любых ???r, то ошибка  должна быть 
    |??(t)| ? ?r                                                                                                  (6.49)
где ar , ?r, ?r - соответственно заданные предельная амплитуда входного сигнала, область рабочих частот, заданная предельно допустимая ошибка.
4) 	Если помеха имеет вид 
  N? (t) = aN cos ?t, aN ?  aN                                                                       (6.50)
при  ????N, то установившаяся ошибка от неё должна быть
   | ? ? | ?   ?N,     ???N                                                                               (6.51)
Требование 1) означает устойчивость системы и оно является непременным условием её работоспособности. Требования 2) - 4) определяют некоторые важные качественные характеристики.
Все требования к системе могут быть обеспечены только вариацией параметров регулятора, который чаще всего является звеном обратной связи. В конечном итоге все характеристики обеспечиваются подбором вида переходного процесса системы под влиянием ненулевых начальных условий, при воздействии на её вход  возмущения и управления. Процессы эти зависят от передаточных характеристик, от расположения корней на комплексной плоскости. Требования, предъявляемые к системе противоречивы: например для сокращения времени отработки управляющего воздействия и повышения точности отработки следует увеличивать коэффициент усиления системы, но это может привести к её низкой устойчивости.
6.3.2. Удовлетворение некоторых требований
Теперь покажем один из способов удовлетворения этих требований, основанный на использовании типовых воздействий на систему.
Пусть воздействие на систему имеет вид
r(t) = a0 + a1t + ....+ aN tN, t ? 0                                                                   (6.52)
тогда : Теорема. Установившаяся реакция устойчивого звена на полиномиальное воздействие вида (52) также является полиномом, представимым в виде
y? (t) = c0 r(t) = c1Dr(t) + ... + cN DN r(t)                                                   (6.53)

где  ck  = 1 / k! [dk H(p) / dpk] p=0 , k = 0, 1, ..., N .                                  (6.54)
 
Отсюда: а) если r(t) = a0 , t ? 0, то установившаяся реакция устойчивого звена также постоянная величина и равна
  y? (t) = H(0) a0;
               б) если r(t) = a0  + a1t , t ? 0, то установившаяся реакция устойчивого звена равна 
y? (t) = H(p) |p=0 (a0 + a1t)  + dH(p) / dp |p=0 a1. 
Применяя этот результат к условию 2) из п. 6.3.1. получим для установившейся ошибки 
? ?  (t) = r(t) - y ? (t) = [1 - Hз (0)] (a0 + a1t)  +  [d(1 - Hз (p)) / dp]p=0 a1     (6.55)
Отсюда видно, что ошибка может быть ограничена при а1 ? 0 только в случае выполнения условия астатизма      
 Нз (0) = 1                                                                                                   (6.56)
т.к.                    Нз (р) = Нр(р) [ 1 + Нр(з) ] -1
то для выполнения (6.56) должно быть  Нр- 1 (0) = 0. Чтобы убедиться в этом, достаточно умножить числитель и знаменатель правой части последнего выражения на Нр- 1(0):

(Нр(0) Нр- 1(0)) [1 Hp- 1(0)  +  Hp(0) Hp- 1(0) ]- 1 = 1.
Это возможно только, если разомкнутая  передаточная функция имеет нулевой полюс, т.е. в знаменателе члены вида (р - 0) = р. Если этот полюс простой, то передаточную функцию разомкнутой системы можно представить в виде
Нр(р) = kp H1p(p) / p,   H1p(0) =1,  kp = const                                            (6.57)
тогда d/dp[1-Hз(p)]p=0 = d/dp[p/ (p + kpH1p(p))]p=0 = kp- 1 
и следовательно из (6.55) получим
? ? =a1 kp- 1 = const.
Таким образом для выполнения требования 2) из п. 6.3.1  можно принять разомкнутую передаточную функцию  в виде (6.57), причем коэффициент kр должен удовлетворять условию
                                                                                                  (6.58)
где  ?0- 1 - называется добротностью системы.
Теперь обратимся к требованию 3) из п. 6.3.1  мы знаем, что реакция линейной дифференциальной системы на гармоническое воздействие является гармонической функцией с амплитудой 
 a ?  =  | 1 - H з (j?)| a r , следовательно, для удовлетворения требования (6.49) необходимо, чтобы желаемая передаточная функция замкнутой системы подчинялась ограничению
 | 1  -  Hз (j?)|  ? ?= ? r ,  ??? r                                                                 (6.59)
что эквивалентно ограничению на разомкнутую передаточную функцию. 
| 1 + Hp (j?) |  ? ? r - 1 ,           ??? r                                                             (6.60)
Требование 4) п. 6.3.1  также учитывается через ограничения на передаточную функцию системы в виде
| Hз (j?) | ? = ? N ,  ??? N                                                                      (6.61)
или  через разомкнутую п.ф. 
 | 1  +  Hp(j?) | ? ? N- 1  ,     ???N                                                                 (6.62)
Все требования обеспечиваются выбором передаточной функции замкнутой системы. Если передаточная функция объекта не удовлетворяют сформулированным требованиям, то при разработке регулятора вводятся обратные связи, обеспечивающие удовлетворение этих  требований через замкнутую передаточную функцию.

7. Цифровые системы управления.
7.1. Модели, формула полной реакции, устойчивость.
7.1.1. Модели
Обратимся теперь к дискретным системам, которые описываются  моделями вида (2.6), (2.8).

 
				

z(t) = z(ti) = z(i)  ?t? [ti , ti+1), интервалы ?t i  = t i+1 - t i не обязательно должны быть равными ;
моменты времени можно занумеровать  t i+1 = ti + ?ti,  i = 0, 1, ...,  ti ? i.
Часто для удобства и простоты принимают ?ti  =  ?t  ?  i = 0, 1, ..., тогда 
ti = t0 + i?t или при t0=0   ti =  i?t.
Описание дискретных систем можно осуществлять дискретными уравнениями вида
x(i + 1) = A(i) x(i) + B(i) u(i)						              (7.1)
y(i+1) = C(i+1)x(i+1).     							              (7.2)
Из описания следует, что это нестационарная система. Её динамика описывается разностным уравнением (7.1), которое является аналогом дифференциального уравнения в непрерывной системе. Уравнение для выходных величин (7.2)  здесь является чисто алгебраическим. Указание номера момента времени у матриц подчеркивает, что они меняются в зависимости от момента времени, их элементы являются функциями номера i. 
Если матрицы постоянны , т.е. они числовые, то система будет стационарной
x(i + 1) = A x(i) + B u(i)							              (7.3)
y(i+1) = C x(i+1).      						                        (7.4)
Смысл векторов и матриц в моделях (7.1) - (7.4) тот же, что и в уравнениях непрерывной системы.
Дискретные системы могут возникать естественным образом или в результате дискретизации исходно непрерывной системы.
Пример естественной дискретной системы. Банковский счет: x(i) - сумма на счете,  a(i) - процентная ставка в банке в  i - месяц,  u(i) - суммарный взнос в i - месяц, тогда  
x(i+1) = a(i)x(i) + u(i) , i = 0, 1, 2,..., x(0) - задано (начальное состояние)

7.1.2. Дискретизация непрерывной модели
Во многих ситуациях целесообразно перейти от непрерывной модели к дискретной. Для преобразования сигналов существуют преобразователи (например, непрерывных в дискретные импульсный элемент и фиксатор нулевого порядка для обратного преобразования).
Преобразование непрерывной модели объекта в дискретную может осуществляться приближенно, опираясь на замену дифференциалов в уравнениях отношениями конечных разностей, или более точно следующим образом. Пусть имеется объект, описываемый  дифференциальными уравнениями
 (t) = A(t)x(t) + B(t)u(t)   							                 (7.5)
y(t) = C(t)x(t)           							                 (7.6)

 


u(t) = u(ti)   ?t?[ti ,ti+1) 
Уравнение (7.5) есть уравнение (5.1) и его решение имеет вид (5.9):
x(t) = Ф (t,t0)x(t0)  +  Ф (t,?) B(?) u(?)d?				                  (7.7)
обозначим t = ti+1 ? i+1,  t0 = ti ? i, u(?) = u(t0) ?  t0 ? ? ? t; 
А(i ) = Ф(i+1,i) = Ф(t, t0),  В(i ) = Ф (ti+1 ,? ) В(?)d? .
Применив эти обозначения, получим из (7.7)
x(i+1) = A(i)x(i) + B(i)u(i)     				                                      (7.8)
y(i+1) = C(i+1) x(i+1)        				                                      (7.9)

Если  система стационарная, то матрицы вычисляются особенно просто
Ф(t,t0)  = eA(t-t0)  =eA?t ,  ?Ф(t,?) d? B =  ? e A(t - ?) B

7.1.3. Решение разностных уравнений состояния
Теорема 1. Рассмотрим разностное уравнение состояния
x(i+1) = A(i) x(i)  +  B(i) u(i)                                                                         (7.10)
Решение его может быть представлено в виде	
x(i) = Ф(i,i0)x(i0)  +   Ф(i,j+1)B(j)u(j),    i?i0 + 1                                  (7.11)
где Ф(i,i0), i ? i0    есть матрица
                                (7.12)
Переходная матрица Ф( ) является решением матричного уравнения 
                                           (7.13)
Если система стационарная , то 
А(i) = A   i
Ф(i,i0) = Ai - i0                                                					   (7.14)
Формулы (7.11) и (7.12) могут быть получены непосредственно по модели (7.10), если в ней выражать х(i) через x(i-1), x(i-1) - через x(i-2) и так далее до x(i0). 
Выходная переменная описывается уравнением (7.9), пусть x(i0) = 0. Подставив (7.11) в (7.9) получим следующую зависимость для выходной переменной y(i):
y(i) =  K(i,j) u(j), i  ? i0 ,  				                                   (7.15)
где      
                           (7.16)
(7.16) представляет собой матричную импульсную переходную функцию системы. Если А постоянная матрица, то К(i,j) = К(i-j). Если система имеет прямую связь, т.е. если выходная переменная описывается следующим образом:
y(i) = C(i)x(i)  +  D(i)u(i)              				                         (7.17),
то  
                           (7.18)

7.1.4. Устойчивость
Ограничиваясь системами с постоянными параметрами, нетрудно видеть, что переходная матрица выражается через степени матрицы А. Матрицу А можно привести к диагональному виду, когда на главной диагонали будут стоять корни характеристического уравнения ?i , а все остальные элементы будут равны нулю. Степени матрицы А выразятся через соответствующие степени собственных чисел (корни). Таким образом, решение можно представить в виде композиции расходящихся при  |?i| ? 1, установившихся при  |?i| = 1  и сходящихся при |?i| ? 1 движений по собственным векторам.
На дискретные системы можно перенести всё сказанное для непрерывных систем, заменив условие отрицательности корней в случае непрерывных систем, условием |?i| ? 1.
Например, линейная дискретная система с постоянными параметрами 
x(i+1) = Ax(i) асимптотически устойчива в том и только в том случае, если все характеристические числа матрицы А по модулю строго меньше единицы.
7.2. Оптимальные линейные дискретные регуляторы
Рассмотрим систему  (7.1)
x(i + 1) = A(i) x(i) + B(i) u(i)                                                                        (7.19)
и на её примере покажем наиболее простой способ определения оптимального в некотором смысле управления. Смысл оптимальности обычно определяется критерием или “закладывается” в него.     
Будем управлять состояниями и введем критерий
x T(i+1) V1(i+1) x(i+1)  + uT(i) V2(i) u(i)  ? min                                         (7.20)
В критерии - два слагаемых, являющихся квадратичными формами. Будем считать, что состоянием является отклонение соответствующих величин от заданных значений. Тогда  первое слагаемое в (7.20) представляет собой квадратичную форму от этих отклонений. Матрица V1 задает приоритеты отклонениям состояний, ранжирует их по важности.  Для наглядности предположим, что весовая матрица  V1 диагональная. Тогда первое слагаемое в (20) в развернутом виде выглядит так:
x T(i+1) V1(i+1) x(i+1) =   V1 kk (i+1)x2k (i+1)
и представляет сумму квадратов  ошибок состояний.
Второе слагаемое в (7.20) по структуре полностью совпадает с первым, но  представляет квадратичную форму от управлений и является нежестким ограничением на их величину.
Если мы будем варьировать значения матрицы V¬1 ¬по отношению к V2, то мы можем переносить ограничения с u на x. 
Заметим, что в (7.20) не входит  начальное состояние, которое задано, т.к. на него мы не можем воздействовать, и не входит управление в последний момент времени, т.к. оно  влияет на состояния в момент времени после рассматриваемого.
Задача оптимального управления состоит в том, что нужно найти последовательность управляющих воздействий u(i0+1), u(i0+2)…, которая обеспечивает выполнение (7.20).
Можно было бы эту задачу попытаться решить “в лоб”, т.е. выписать выражения для всех х от х(i0) до конечного x(N). Из x  R , u  R  N*r решений – размерность слишком велика. Целесообразным будет попытаться свести эту N*r – мерную задачу к N задачам r – й размерности.
Для устранения этой проблемы используется принцип оптимальности Беллмана.
Теорема. При любом начальном состоянии и оптимальном начальном управлении последующее управление должно быть оптимальным относительно состояния, возникшего в результате начального управления.
Доказательство производится от противного.  Рассмотрим на некотором интервале времени t1? t ? t2 систему S с вектором управления u  и вектором состояния x . Время может быть дискретное или непрерывное, концы могут быть свободными или закреплёнными. Пусть Q некоторый критерий качества, который оптимизируется на заданном интервале [t1, t2], например, минимизируется.
Допустим, что существует, по крайней мере, одно управление u(t), удовлетворяющее всем ограничениям и минимизирующее Q на [t1, t2], обозначим это оптимальное управление  u0(t), а соответствующее ему значение критерия  Q0. 
Рассмотрим некоторый момент времени t’ ?[t1,t2] и предположим, что на интервале [t’,t2] существует управление u*(t), для которого значение критерия Q  меньше, чем для u0(t) на этом же интервале и при том же начальном состоянии. Поэтому комбинированное управление
 
обеспечивает значение критерия Q**? Q0 на интервале [t1,t2]. Но по условию u0(t) является оптимальным управлением, которое не может быть улучшено. Следовательно, имеем противоречие, которое и доказывает теорему.   
      Принцип оптимальности позволяет сформулированную выше задачу определения вектора управлений размером N*r – мерную задачу разделить на N r-мерных задач. При использовании принципа оптимальности решение осуществляется в обратном порядке, т.е. сначала определяется управление u(N-1), переводящее систему в конечное состояние x(N) из состояния x(N-1). При этом в соответствии с принципом оптимальности принимается, что управление  u(N-1) должно быть оптимально относительно состояния x(N-1). Так что последнее управление будет в соответствии с принципом оптимальности  оптимальным. Затем определяется управление u(N-2) и т.д. до u (0).  
     Рассмотрим решение одношаговой задачи определения u(N-1).  
Обозначим Q1= [xT(N)V1(N)x(N) + uT(N-1)V2(N-1)u(N-1)]              (7.22)
В соответствии с (7.19) имеем
x(N) = A(N-1)x(N-1)  + B(N-1)u(N-1)
Подставим этот результат в (7.22) и получим 
Q1 =  {[ A(N-1)x(N-1)  + B(N-1)u(N-1)]T V1(N) [A(N-1)x(N-1) + 
+ B(N-1)u(N-1)] + uT (N-1)V2(N-1)u(N-1)} =
= {xT(N-1)AT(N-1)V1(N)A(N-1)x(N-1)+xT(N-1)AT(N-1)V1(N)B(N-1)u(N-1) + uT(N-1)BT(N-1)V1(N)A(N-1)x(N-1) + uT(N-1)[BT(N-1)V1(N)B(N-1) + 
+ V2(N-1)]u(N-1)}.
Второе слагаемое в скобке равно транспонированному третьему, а т.к. они скаляры, то они равны, и можно записать
Q1 = {xTATV1Ax + 2xTATV1Bu + uT[BTV1B + V2]u}                           (7.23)
Чтобы найти минимум необходимо приравнять нулю градиент Q1 по управлению:
    = 2xTATV1B + 2uT[BTV1B + V2] = 0.
Решая это уравнение относительно неизвестного управления, получим                               
u(N-1)=-{BT(N-1)V1 (N)B(N-1) + V2(N-1)}-1BT(N-1)V1(N)A(N-1)x(N-1)  (7.24)
Это линейный оптимальный закон управления, его физическая реализуемость обеспечивается соответствующим выбором матрицы V2. 
Обозначим матрицу обратной связи, определяющую регулятор S(N-1)
S(N-1)=-{BT(N-1)V1(N)B(N-1) + V2(N-1)}-1BT(N-1)V1(N)A(N-1)             (7.25)
тогда закон управления записывается в виде
u(N-1) = S(N-1)x(N-1)                           				                (7.26)
Матрица S(N-1) называется матрицей обратной связи системы управления.
Далее можно подставить найденное управление в критерий и найти его значение. Затем решается двухшаговая задача. Положив 
Q2=  {[xT(N-1)V1(N-1)x(N-1)+uT(N-2)V2(N-2)u(N-2)] +
 + [xT(N)V1(N)x(N) + uT(N-1)V2(N-1)u(N-1)]}, т.к. выбор u(N-1) не влияет на x(N-1)  , а x(N)  уже определено и минимальное значение критерия Q1 уже найдено, то для минимизации Q2 достаточно решить задачу 
Q2 =   {[xT(N-1)V1(N-1)x(N-1)+uT(N-2)V2(N-2)u(N-2)] +Q1}         (7.27)
Из (7.27) видно, что для определения u(N-2) нужно решить такую же задачу, которая была рассмотрена для u(N-1), т.к. (7.27) ничем не отличается от (7.23).
Дальше процедура определения управлений на всех шагах до u(0) абсолютно одинакова.
Кроме того, можно получить, что управления на каждом следующем шаге и значения критерия оптимальности выражаются с помощью рекуррентных формул через предыдущие, что делает процедуру определения оптимального линейного регулятора для многошагового процесса достаточно простой при цифровой реализации.
8. Стохастические системы
8.1. Характеристики и определения
Часто на систему действуют различные возмущающие воздействия, имеющие случайный или стохастический характер.
Стохастический процесс - это семейство случайных функций времени. Каждая отдельная функция времени называется реализацией процесса.  
 
Пусть ?¬1(t), ?2(t), …,?n(t)  - скалярные стохастические процессы, тогда 
V(t) = (?¬1(t), ?2(t), …,?n(t)) ¬Т                                                                    (8.1)
векторный стохастический процесс. Пусть его компоненты принимают действительные значения. t>= t0, t0 – задано.
Стохастический процесс может быть определен заданием совместного распределения вероятностей
P ( v(t1) ?v1, v(t2) ?v2, …, v(tm) ?vm, )                                                           (8.2)
Для всех действительных значений v1, v2, …, vm,  t1 ,   t2 ,  …, tm  и для любого натурального m. 
Запись v(ti) ?vi   означает
?¬j (ti ) ? ?ij  , j = 1,2, …, n, i = 1,2,…, m.                                                         (8.3)
Т. к. (8.2) известно не всегда, то часто пользуются не менее ёмкими характеристиками, характеризующими совместное распределение.
Стохастические процессы могут быть стационарными и нестационарными.
Определение. Стохастический процесс V(t) является стационарным, если 
P ( v(t1) ?v1, v(t2) ?v2, …, v(tm) ?vm, ) = P ( v(t1 + ?) ?v1, v(t2 + ?) ?v2, …, 
v(tm + ?) ?vm, )                                                                                                 (8.4)
Для любых t1 , t2 ,   ……,tm ,  v1 , … , vm   , для каждого m  и для всех ?.
Т.о. стационарный процесс инвариантен относительно начала отсчета.
Определение. Пусть V(t) – векторный случайный процесс. Тогда 
m(t) = E[ v(t) ]                                                                                                  (8.5)
вектор средних значений процесса;
Rv(t1 ,t2) = E {[ v(t1 ) - m(t1 )] [ v(t2 ) - m(t2 )]T}                                              (8.6)
ковариационная матрица процесса;
Cv (t1, t2 ) = E [ v(t1 )  v T (t2 )]                                                                          (8.7)
матрица смешанных моментов второго порядка;
R v (t  ,t ) = Q (t)                                                                                                (8.8)
матрица дисперсий и
C v (t  ,t ) = Q' (t)                                                                                               (8.9)
матрица моментов второго порядка.
Из (8.6) и (8.7) видно, что если m(t) = 0, то Rv(t1 ,t2) = Cv (t1, t2 ).  Развернутая запись матриц имеет вид
                           
                            [?1(t1)?1(t2)] [?1(t1)?2(t2)]  ….. [?1(t1)?n(t2)]
Cv (t1, t2 ) =   E    [?2(t1)?1(t2)] [?2(t1)?2(t2)]  ….. [?2(t1)?n(t2)]                                    
                               …………………………………… ……..
                            [?n(t1)?1(t2)] [?n(t1)?2(t2)]  ….. [?n(t1)?n(t2)]    
Можно доказать, что Rv(t1 ,t2) и Cv (t1, t2 ) имеют следующие свойства:
а) R v (t2 ,t1) = RT v (t1 ,t2) для любых t 1, t 2  ;
    C v (t2, t1 )  = CT v (t1, t2 ) для любых t 1, t 2  ;
б) Q (t) = R v (t, t ) ? 0  ? t;
    Q' (t) = C v (t , t ) ? 0  ?  t;
в) C v (t1, t2 )  = R v (t1 ,t2)  + m (t1)mT(t2) для любых t 1, t 2  .
Если v(t) - стационарный стохастический процесс, то его среднее значение постоянно, а ковариационная  матрица зависит только от  сдвига аргументов (t1 – t2) . Стохастический процесс v(t) является стационарным в широком смысле, если его матрица моментов второго порядка Cv (t, t) конечна для всех значений времени t.
8.2. Спектральное разложение
Преобразование Лапласа осуществляется с помощью функции  e pt , где  
р = ? ? i? - комплексная переменная. В задачах управления t – время, которое принимает  значения от - ?  до + ?. Величины, получающиеся при решении задач управления должны быть конечными и при  t ? ?  ? т.к. 
e pt = e ?t e i?t = e ?t (cos ?t  + i sin ?t),
и |cos ?t  + i sin ?t| = 1, то при  ? ? 0 |e pt| ??  при t ??  и при ? ? 0 |e pt| ?-?  при t ? - ?. Поэтому, чтобы экспонента была ограниченной необходимо иметь ??0, т.е. чтобы использовались только «гармоники» 
e i?t = cos ?t  + i sin ?t                                                                                  (8.11)

Суммы гармоник  
f(t) = a k e i?k t                                                                                           (8.12)
позволяют получать более сложные функции времени.
Набор частот  ?k в (8.12) называется спектром функции f(t). Используя (8.11) и cos ?t = (e i?t + e - i?t)/ 2, sin ?t = (e i?t - e - i?t)/ 2 i                                 (8.13)
можно переходить от экспонент к косинусам и синусам и наоборот.
Формула (8.12) дает дискретный спектр, т.к. ?k  - дискретные значения.
Если вместо дискретных использовать непрерывные значения, т.е. функцию F(?), то получится непрерывный спектр разложения  функции f(t):
f(t) = F(?)ei?td?                                                                                         (8.14)
при котором частота может занимать всю ось или любую её часть.
В (8.14) на малый интервал частот [?, ? + d?]  приходится слагаемое    и, сравнивая с (8.12), видим, что   это амплитуда колебаний, соответствующая заданному интервалу частот. Т.о.   можно рассматривать как плотность амплитуды, соответствующей заданному интервалу частот, поэтому    называют спектральной плотностью функции f(t). 
Используя представление комплексной функции   с помощью двух вещественных функций    , т.е. 
 
и тригонометрическое представление экспоненты, можно получить следующее представление вещественной функции f(t):
                                                                       (8.15)
Вспомним простые факты из теории колебаний. Пусть имеется колебательный контур – осциллятор с малым сопротивлением (слабым затуханием). Если он испытывает гармоническое внешнее воздействие с частотой ?, то в нём  возбуждаются гармонические вынужденные колебания с той же частотой. Амплитуда этих колебаний тем больше, чем ближе ? к ?0  - собственной частоте колебаний осциллятора. Эта избирательность осциллятора выражена тем сильнее, чем меньше затухание. В предельном случае, когда затухание отсутствует вовсе, при  ? = ?0  наступает явление резонанса, при котором амплитуда растёт неограниченно. Если гармонический внешний сигнал подводится к системе осцилляторов с разными собственными частотами, то отзовётся на сигнал тот из них, у которого собственная частота ближе к частоте воздействия. 
Если на такую систему воздействует смесь гармоник, т.е. воздействие вида (8.12), то на них отзовутся те осцилляторы, у которых собственные частоты совпадают с какой-либо из внешних частот ?к . При этом амплитуда вынужденных колебаний осциллятора с собственной частотой ?к будет пропорциональна амплитуде ак внешнего воздействия на этой частоте.
Аналогичная картина получается при наложении непрерывного воздействия (8.14). Т.о. система осцилляторов позволяет осуществлять гармонический  или спектральный анализ внешнего воздействия. Формулы (8.14), (8.15) позволяют по спектральной плотности восстановить функцию f(t). Обратная операция   выполняется для конечной функции f(t) при t ?? ? по формулам:
                                                                                                                   (8.16)
или (отдельно для действительной и мнимой частей):
                                                                             (8.17)
при этом, как и раньше,  .
	8.3. Матрицы спектральных плотностей энергии	
Определение. Матрица спектральной плотности энергии ? v( ?) векторного стохастического процесса стационарного в широком смысле, определяется  как преобразование Фурье ковариационной матрицы R v(t1 – t2) процесса, т.е.
                                                                               (8.18)
где  ? = t1 – t2.
? v(?) является  комплексной матрицей, имеющей свойства:
а)   ? v(- ?) = ? v?(?)   ? ?                                                                           (8.19)
б)  ? v?(?) = ? v(?)      ? ?                                                                            (8.20)  
в)   ? v(?) ? 0              ? ?                                                                             (8.21)
? - обозначает комплексно-сопряженное транспонирование.
8.4. Задачи слежения
При исследовании задач слежения и проектировании регуляторов или алгоритмов управления используют для характеристики качества систем среднее значение квадрата ошибки слежения Ce(t) и среднее значение квадрата управляющей переменной C u(t), которые определяются так:
                                                                                          (8.22)
                                                                                              (8.23)
где    - ошибка                                                                                  (8.24) 
  и u(t) – векторы соответствующей размерности, r(t) – заданное значение текущей величины, We(t), Wu(t), t ? t0 – неотрицательно определённые весовые матрицы, которые задают приоритеты компонент векторов e и u по отношению друг к другу.
Для получения выражений для ошибки и управления записываются уравнения объекта и регулятора, из них исключаются (подставляются друг в друга) управления из уравнений объекта и выходные величины из уравнений регулятора. В результате определяется выходная величина, которая подставляется в (8.24), а результат в (8.22), управления подставляются в (8.23). Таким образом,  величины (8.22), (8.23) выражаются через матрицы (характеристики) объекта и регулятора. Это позволяет выбрать параметры регулятора так, чтобы удовлетворить ряд принципов проектирования систем регулирования.
8.5. Некоторые принципы проектирования
Основной принцип проектирования. При проектировании систем следует добиваться самого низкого из возможных среднего значения квадрата ошибки слежения, не допуская при этом превышения средним значением квадрата управляющей переменной некоторого заданного значения.
Принцип проектирования. Система должна быть асимптотически устойчивой. 
При анализе характеристик (8.22), (8.23) процесс управления делится  на переходный и установившийся период. Продолжительность переходного периода ограничивается временем установления установившейся ошибки.
Эталонную переменную можно представить в виде
r(t) = r0 + r v(t),                                                                                                (8.25)
где r0  - стохастический вектор – постоянная часть эталонной переменной,
r v(t)   - переменная часть эталонной переменной.
Обозначим T(p) – передаточную функцию замкнутой системы от r(t) до управляемой переменной  z(t); выходная переменная, как и раньше, y(t);  N(p) – матричная передаточная функция замкнутой системы от эталонной переменной r(t) на управляющую переменную u(t).
Пусть   ,                                                                                                             (8.26)
 .                                                                                                              (8.27)
Тогда для простого случая скалярных r, u, y, z   и   We = 1, Wu  = 1 можно получить следующие выражения
     ? r (?) |T(i?) – 1|2 df ,                                      (8.28)
                                                         
  .                                                   (8.29)
Первое слагаемое характеризует зависимость от установившегося значения r0, а второе – от переменной составляющей эталонного сигнала.
Анализ соотношения  (8.28) позволяет сделать некоторые выводы. Т.к.  основной принцип  состоит  в  , то отсюда следует принцип проектирования: чтобы обеспечить малое установившееся среднее значение квадрата ошибки слежения, передаточную функцию T(p) линейной системы управления с постоянными параметрами следует выбирать таким образом, чтобы выражение
? r (?) |T(i?) – 1|2                                                                                        (8.30)
принимало малые значения для всех действительных частот. В частности, если заданные точки нулевые, то значение T(0) должно быть близким к 1.
В задачах регулирования переменная часть  эталонной переменной ? r (?) = 0 и нужно, чтобы T(0) =1. Под  интегралом  (8.28) стоит выражение (8.30). Обычно ? r (?) имеет существенное значение в области низких частот и убывает с ростом частоты, см. рис. 8.1. 
 
Рис. 8.1. (А-амплитуда или мощность ?).
Поэтому для того, чтобы получить малое (8.30) необходимо, чтобы |T(i?) – 1| было малым в области низких частот, где ? r (?)  велико.     
 В связи с этим вводится понятие полосы частот системы и входного сигнала.  
Пусть T(p) – скалярная передаточная функция асимптотически устойчивой линейной системы с постоянными параметрами и скалярными управлением и управляемой переменной. Тогда полосой частот системы управления является множество частот ?, ? ? 0, для которых 
| T(i?) – 1 | ? ?                                                                                                (8.31)
где   ?  -  заданное число, малое по сравнению с 1.
    Если полоса частот представляет собой  интервал  [?1, ?2], то разность   ?2  - ?1  является полосой пропускания системы.
Если  интервал имеет вид [0, ?с], то  ?с  называется частотой среза системы.      
 
Рис. 8.2. Иллюстрация низкочастотной системы. 
Если ? = 0.01 (1%), то ?с называется однопроцентной частотой среза.
Пусть r(t)  скалярный стационарный в широком смысле  стохастический процесс со спектральной плотностью ?r(?) .  Полоса частот ?  процесса r(t)  определяется как множество частот ?,  ? ? 0, для которых  
  ? r (?) ? ?                                                                                                     (8.32)
Значение ? выбирается так, чтобы полоса частот содержала  заданную часть 1 - ?  (??? 1) половины энергии  процесса, т.е.
                                                                   (8.33)
Если полоса представляет собой интервал [?1, ?2], то разность ?2  - ?1  является полосой пропускания процесса.
Если интервал имеет вид [0, ?с], то  ?с  называется частотой среза процесса.  
  
Рис. 8.3.
[0, ?с] – низкочастотная часть процесса, При  ? = 0.01  говорят об 1? частоте среза. При этом [0, ?с] содержит 99% от половины энергии процесса (спектра). 
С учетом этих понятий из  (8.28), (8.30) следует принцип проектирования: для получения малого значения ошибки слежения необходимо, чтобы полоса частот системы управления содержала как можно большую часть полосы пропускания эталонной переменной. Если заданные точки (частоты) нулевые, то следует стремиться, чтобы Т(0) было близким к 1.
 
Рис. 8.4. (иллюстрирует сказанное: (?r(?), |T(i?) – 1|), 1 – полоса  пропускания системы, 2 – полоса пропускания входного процесса 
(эталонной переменной),  3 – диапазон частот эталонной переменной, неперекрываемый полосой пропускания системы, который и будет приносить наибольший вклад в среднее значение квадрата ошибки слежения.)
Входная переменная должна быть минимальной. Это требование отражено в следующем принципе проектирования:                                             
в асимптотически устойчивой линейной системе с постоянными параметрами со скалярным входом и выходом для получения малого установившегося среднего значения квадрата входной переменной необходимо, чтобы
            	                                                                             (8.34)
принимало малые значения для всех действительных значений ?. Для этого  необходимо делать |N(i?)| малым в полосе частот эталонной переменной. Принцип не касается N(0), входящего в (8.29), которое ориентировано на постоянную часть эталонной переменной. Второй член в (8.29) определяет изменение входной переменной относительно начального состояния.  Из сопоставления принципов проектирования видно, что удовлетворить их можно изменением передаточных матриц Т(р) и N(p). Но можно показать, что они связаны соотношением  Т(р) = К(р)N(р), поэтому изменять их независимо нельзя и нужен компромисс, найти который и должен проектировщик системы.

8.6. Оценка длительности переходных процессов
Установившаяся ошибка или состояние системы достигаются после некоторого переходного процесса, в котором значения ошибки могут быть существенно больше. Поэтому длительность переходных процессов желательно уменьшать.
Временем установления определенного процесса (среднего значения квадрата ошибки, например) называется время, в течение которого переменная достигает установившегося значения в пределах заданной точности. Если точность 1% от максимального отклонения от установившегося значения, то говорят об 1% времени установления. В начальный момент ошибка может быть большой. 
Отсюда принцип проектирования: система должна быть спроектирована так, чтобы время установления среднего значения квадрата ошибки  слежения было по возможности малым. 
В соответствии с (8.28) среднее значение квадрата ошибки слежения состоит из двух частей. Одна обусловлена переменной составляющей эталонной переменной, а другая  - постоянной. Поведение составляющей от переменной части оценивается дисперсией, которая находится трудоёмким решением матричного дифференциального уравнения. Анализ поведения в переходном процессе составляющей от постоянной части эталонной переменной проще. Его можно выполнить, анализируя переход системы из ненулевых начальных условий и реакцию на ступенчатое входное воздействие эталонной переменной. Для асимптотически устойчивой линейной системы с постоянными параметрами некоторую информацию  можно получить из расположения на плоскости полюсов замкнутой системы. Все реакции такой системы представляют собой экспоненциально демпфированные движения с постоянными времени, равными отрицательным обратным величинам действительных частей характеристических чисел замкнутой системы. Поскольку 1%-е время установления экспоненциального процесса  эталонной переменной
                                                                                                      (8.35)
равно 4,6?, граница для 1%-го времени установления ts какой-либо переменной определяется формулой:
 	                                    			               (8.36)
где ?i , i = 1,2, …,n  - характеристические числа системы. Заметим, что для квадрата переменной время установления равно половине времени, необходимого для самой переменной.
 9. Адаптивные системы
9.1. Основные схемы адаптивных систем. Понятие структурной и параметрической идентификации
      ЦВМ открыли большие возможности  для использования информации, снимаемой с объекта, для улучшения качества управления или характеристик регулятора. Широкое распространение получили адаптивные, самонастраивающиеся системы, в которых реализуется автоматическая подстройка параметров системы на основе анализа и обработки информации об эффективности процесса регулирования.
 
Рис. 9.1.  Общая схема адаптивной системы управления (r, u - входы,   - параметры).
1-й блок – это реальный объект, точное описание которого неизвестно. 2-й блок – более или менее точное его описание, 3-й – закон управления. 
Модель (2-й блок) – приближённая и объект изменяется во времени. Улучшение модели называется идентификацией (повышение её точности). Идентификация имеет 2 стороны:
  структурная;
  параметрическая.  
Под структурной идентификацией понимается приближение структуры модели к реальной так, чтобы она наилучшим образом отражала объект. Так как объекты могут быть самыми различными (механическими, экологическими и др.) нельзя придумать формальных методов структурной идентификации. 
4-й блок (рисунок 9.1) отражает параметрическую идентификацию. Параметрическая идентификация – это улучшение значений параметров модели с целью повышения точности модели. Точность всегда понимается как разность между прогнозируемым и тем, что получаем. 
5-й блок (рисунок 9.1) осуществляет адаптацию параметров регулятора.
Адаптация означает подстройку параметров регулятора, его самообучение. Параметры регулятора зависят от параметров объекта и обычно выражаются через них. Изначально параметры объекта не всегда известны с достаточной степенью точности или “плывут” во времени, что и вынуждает прибегать к адаптации. Поэтому адаптации – изменению характеристик регулятора – обычно предшествует процедура уточнения характеристик объекта по результатам измерения  входных и выходных величин, которая называется  идентификацией. Вопросы идентификации и адаптации получили  резкое развитие в последние 25-30 лет, благодаря быстрому росту ресурсов цифровых контроллеров с одновременным снижением их стоимости.  
     Главная отличительная особенность адаптивных систем от систем с постоянными параметрами состоит в том, что они могут автоматически приспосабливаться к изменяющимся внешним условиям, могут обучаться подстройкой регулятора. Используются два основных способа подстройки регулятора.
    Если изменяющиеся динамические свойства объекта доступны контролю по измеряемым внешним факторам и известно, как должен настраиваться регулятор  в зависимости от параметров объекта, то можно использовать прямой метод настройки или адаптацию по разомкнутому контуру     
                                                                                                

 

Рис. 9.2.  (А - адаптер, Р – регулятор, О – объект).
Если характеристики объекта  измерить и оценить непосредственно нельзя, то используют адаптацию по замкнутому контуру (с обратной связью).  В этом случае в систему вводится второй контур управления, который управляет не поведением объекта, а структурой и параметрами регулятора.
Адаптивные регуляторы с обратной связью можно разделить на два  класса: самостабилизирующиеся регуляторы и регуляторы  с эталонной моделью.
В самонастраивающейся системе имеется идентификатор, который постоянно определяет параметры объекта, и корректор регулятора, который на основании заданного критерия оптимальности сопоставляет текущие значения параметров объекта с теми, на основании которых функционирует регулятор, принимает решение об изменении характеристик регулятора и реализует это решение. 
В этой системе можно выделить этапы:
1. Идентификация объекта или системы в целом.
2. Расчет коррекции регулятора. 
3. Коррекция (настройка) регулятора, изменение его структуры.    
            
                                                   Рис. 9.3. 
При использовании эталонной модели задача состоит в такой настройке  замкнутого контура управления, чтобы реакция системы на некоторый сигнал была бы максимально близка к реакции на этот сигнал эталонной модели. В этом случае должен измеряться некоторый внешний сигнал (эталонное воздействие r(t) в следящей системе) и адаптация осуществляется в те моменты, когда этот сигнал начинает изменяться. Здесь тоже выделить три этапа:  
1.	Сравнение реакции контура и эталонной модели.
2. Расчет коррекции регулятора.                                                                     
     3. Коррекция регулятора.
 
																		Рис. 9.4.
9.2. Идентификация параметров объекта. Метод наименьших квадратов
Задача идентификации параметров объекта состоит в следующем. Имеется обучаемая модель объекта
 ,	                					                  (9.1)
имеется обучающая выборка
 				                                                (9.2)
Требуется определить модель f так, чтобы прогнозируемые по модели (1) значения у минимально отличались от измеренных значений y’ при одних и тех же значениях входных переменных x’. В качестве меры близости прогнозируемых значений у к измеренным y’ чаще всего используют квадратичную ошибку
 				                                                       (9.3)
Подставив сюда у в соответствии с (9.1), получим
                                                        (9.4)
Наилучшее приближение соответствует минимальному значению (9.4).  В нём все величины, кроме параметров ? j, заданы. И только их значениями можно влиять на значение F(?). Известно, что значения ?, при которых достигается экстремум, находятся приравниванием нулю производных. Таким образом, получаем систему уравнений 
                                                                              (9.5)
где J – количество параметров.

9.3. Общий алгоритм метода наименьших квадратов
Пусть теперь имеется дискретный объект, описываемый разностным уравнением:
  		        (9.6)
Допустим, что нам известны оценки параметров модели объекта  , полученные после k-1 такта, а также измеренные значения входов и выходов  . Подставив их в (9.6), определим прогнозируемые (предсказанные) значения	выходной переменной. Обозначим его   :
                                                                                                                                (9.7)
где
             (9.8)
                                        			                  (9.9)
После того, как значение y(k) измерено, мы можем вычислить невязку- ошибку прогноза:
                                                                             (9.10)
Допустим, что измерения выполнены для k=1,2…,m+N. Тогда мы можем записать систему из N+1 уравнения в виде
 	    	                                    (9.11)
где   	    		                          (9.12)
 	                                                         (9.13)

                                                                                                                           
 (9.14)
Функцию потерь примем в виде (3), т.е.   и получаем
                                                              (9.15)
Значения оценок параметров   находятся, как и выше из уравнений
 .                               				                                    (9.16)
Полагая, что N?2m,   обозначим
 .                                                               (9.17)
Тогда для вычисления оценок получим общий алгоритм
                                               (9.18)
Это нерекуррентный алгоритм. В нем необходимо обращать матрицу (9.17). Из (9.14) следует, что её размерность  , где 2m общее число оцениваемых параметров модели. Обычно m велико и обращение трудоёмко. 
9.4. Рекуррентный метод наименьших квадратов
Для текущей идентификации предпочтительнее рекуррентные процедуры, исключающие необходимость обращения с одной стороны, а с другой позволяют идентифицировать модель в реальном времени по постоянно поступающим эмпирическим данным. В рекуррентном алгоритме МНК присутствует параметр  , который регулирует скорость сходимости или определяет весовые коэффициенты вновь получаемых измерений по отношению к уже имеющимся. Идентификацию можно представить как обычный процесс регулирования, но не выходных величин какого-то объекта, а параметров модели функцией невязки между прогнозом по модели и реальным значением:  , где k – момент или номер измерения, i – номер параметра.
 
Рис. 9.5.
Если   взять большим, то ошибки попадут в модель.
Чтобы его получить, достаточно записать выражения для   и второе вычесть из первого. В результате получим
                                                  (9.19)
                  (9.20)
                                                                   (9.21)
Начальные значения принимаются равными
 					                                             (9.22)
где ? должно быть достаточно большим.
Формулу (9.19) можно записать  и так:
                                                                           (9.23)
Заметим, что математическое ожидание матрицы Р с точностью до скалярного множителя равно ковариационной матрице вектора оценок параметров модели
                                                   (9.24)



